package com.ajx.attendance.dao;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.springframework.stereotype.Repository;

import com.ajx.attendance.utils.BaseDao;

@Repository
public class ShowAttendanceDao extends BaseDao{	
	public List<Map<String,Object>> getAttendance(String deptid,String date,boolean flag) throws ParseException{
//		SimpleDateFormat sdf=new SimpleDateFormat("yyyy-MM");
//		Date date1=sdf.parse(date);
		String year=date.substring(0, date.indexOf("-"));
		int ye=Integer.parseInt(year);
		String month=date.substring(date.indexOf("-")+1,date.length());
		int mon=Integer.parseInt(month);
		List<Map<String,Object>> list=null;
		String sql="select name,deptname,emp_no,"
		+"sum(case when a1='培训' then 1 else 0 end)+sum(case when a2='培训' then 1 else 0 end)+sum(case when a3='培训' then 1 else 0 end)+sum(case when a4='培训' then 1 else 0 end)+sum(case when a5='培训' then 1 else 0 end)+sum(case when a6='培训' then 1 else 0 end)+sum(case when a7='培训' then 1 else 0 end)+sum(case when a8='培训' then 1 else 0 end)+sum(case when a9='培训' then 1 else 0 end)+sum(case when a10='培训' then 1 else 0 end)+sum(case when a11='培训' then 1 else 0 end)+sum(case when a12='培训' then 1 else 0 end)+sum(case when a13='培训' then 1 else 0 end)+sum(case when a14='培训' then 1 else 0 end)+sum(case when a15='培训' then 1 else 0 end)+sum(case when a16='培训' then 1 else 0 end)+sum(case when a17='培训' then 1 else 0 end)+sum(case when a18='培训' then 1 else 0 end)+sum(case when a19='培训' then 1 else 0 end)+sum(case when a20='培训' then 1 else 0 end)+sum(case when a21='培训' then 1 else 0 end)+sum(case when a22='培训' then 1 else 0 end)+sum(case when a23='培训' then 1 else 0 end)+sum(case when a24='培训' then 1 else 0 end)+sum(case when a25='培训' then 1 else 0 end)+sum(case when a26='培训' then 1 else 0 end)+sum(case when a27='培训' then 1 else 0 end)+sum(case when a28='培训' then 1 else 0 end)+sum(case when a29='培训' then 1 else 0 end)+sum(case when a30='培训' then 1 else 0 end)+sum(case when a31='培训' then 1 else 0 end) as peixun,"
		+"sum(case when a1='出差' then 1 else 0 end)+sum(case when a2='出差' then 1 else 0 end)+sum(case when a3='出差' then 1 else 0 end)+sum(case when a4='出差' then 1 else 0 end)+sum(case when a5='出差' then 1 else 0 end)+sum(case when a6='出差' then 1 else 0 end)+sum(case when a7='出差' then 1 else 0 end)+sum(case when a8='出差' then 1 else 0 end)+sum(case when a9='出差' then 1 else 0 end)+sum(case when a10='出差' then 1 else 0 end)+sum(case when a11='出差' then 1 else 0 end)+sum(case when a12='出差' then 1 else 0 end)+sum(case when a13='出差' then 1 else 0 end)+sum(case when a14='出差' then 1 else 0 end)+sum(case when a15='出差' then 1 else 0 end)+sum(case when a16='出差' then 1 else 0 end)+sum(case when a17='出差' then 1 else 0 end)+sum(case when a18='出差' then 1 else 0 end)+sum(case when a19='出差' then 1 else 0 end)+sum(case when a20='出差' then 1 else 0 end)+sum(case when a21='出差' then 1 else 0 end)+sum(case when a22='出差' then 1 else 0 end)+sum(case when a23='出差' then 1 else 0 end)+sum(case when a24='出差' then 1 else 0 end)+sum(case when a25='出差' then 1 else 0 end)+sum(case when a26='出差' then 1 else 0 end)+sum(case when a27='出差' then 1 else 0 end)+sum(case when a28='出差' then 1 else 0 end)+sum(case when a29='出差' then 1 else 0 end)+sum(case when a30='出差' then 1 else 0 end)+sum(case when a31='出差' then 1 else 0 end) as chuchai,"
		+"sum(case when a1='病假' then 1 else 0 end)+sum(case when a2='病假' then 1 else 0 end)+sum(case when a3='病假' then 1 else 0 end)+sum(case when a4='病假' then 1 else 0 end)+sum(case when a5='病假' then 1 else 0 end)+sum(case when a6='病假' then 1 else 0 end)+sum(case when a7='病假' then 1 else 0 end)+sum(case when a8='病假' then 1 else 0 end)+sum(case when a9='病假' then 1 else 0 end)+sum(case when a10='病假' then 1 else 0 end)+sum(case when a11='病假' then 1 else 0 end)+sum(case when a12='病假' then 1 else 0 end)+sum(case when a13='病假' then 1 else 0 end)+sum(case when a14='病假' then 1 else 0 end)+sum(case when a15='病假' then 1 else 0 end)+sum(case when a16='病假' then 1 else 0 end)+sum(case when a17='病假' then 1 else 0 end)+sum(case when a18='病假' then 1 else 0 end)+sum(case when a19='病假' then 1 else 0 end)+sum(case when a20='病假' then 1 else 0 end)+sum(case when a21='病假' then 1 else 0 end)+sum(case when a22='病假' then 1 else 0 end)+sum(case when a23='病假' then 1 else 0 end)+sum(case when a24='病假' then 1 else 0 end)+sum(case when a25='病假' then 1 else 0 end)+sum(case when a26='病假' then 1 else 0 end)+sum(case when a27='病假' then 1 else 0 end)+sum(case when a28='病假' then 1 else 0 end)+sum(case when a29='病假' then 1 else 0 end)+sum(case when a30='病假' then 1 else 0 end)+sum(case when a31='病假' then 1 else 0 end) as bingjia,"
		+"sum(case when a1='事假' then 1 else 0 end)+sum(case when a2='事假' then 1 else 0 end)+sum(case when a3='事假' then 1 else 0 end)+sum(case when a4='事假' then 1 else 0 end)+sum(case when a5='事假' then 1 else 0 end)+sum(case when a6='事假' then 1 else 0 end)+sum(case when a7='事假' then 1 else 0 end)+sum(case when a8='事假' then 1 else 0 end)+sum(case when a9='事假' then 1 else 0 end)+sum(case when a10='事假' then 1 else 0 end)+sum(case when a11='事假' then 1 else 0 end)+sum(case when a12='事假' then 1 else 0 end)+sum(case when a13='事假' then 1 else 0 end)+sum(case when a14='事假' then 1 else 0 end)+sum(case when a15='事假' then 1 else 0 end)+sum(case when a16='事假' then 1 else 0 end)+sum(case when a17='事假' then 1 else 0 end)+sum(case when a18='事假' then 1 else 0 end)+sum(case when a19='事假' then 1 else 0 end)+sum(case when a20='事假' then 1 else 0 end)+sum(case when a21='事假' then 1 else 0 end)+sum(case when a22='事假' then 1 else 0 end)+sum(case when a23='事假' then 1 else 0 end)+sum(case when a24='事假' then 1 else 0 end)+sum(case when a25='事假' then 1 else 0 end)+sum(case when a26='事假' then 1 else 0 end)+sum(case when a27='事假' then 1 else 0 end)+sum(case when a28='事假' then 1 else 0 end)+sum(case when a29='事假' then 1 else 0 end)+sum(case when a30='事假' then 1 else 0 end)+sum(case when a31='事假' then 1 else 0 end) as shijia,"
		+"sum(case when a1='婚假' then 1 else 0 end)+sum(case when a2='婚假' then 1 else 0 end)+sum(case when a3='婚假' then 1 else 0 end)+sum(case when a4='婚假' then 1 else 0 end)+sum(case when a5='婚假' then 1 else 0 end)+sum(case when a6='婚假' then 1 else 0 end)+sum(case when a7='婚假' then 1 else 0 end)+sum(case when a8='婚假' then 1 else 0 end)+sum(case when a9='婚假' then 1 else 0 end)+sum(case when a10='婚假' then 1 else 0 end)+sum(case when a11='婚假' then 1 else 0 end)+sum(case when a12='婚假' then 1 else 0 end)+sum(case when a13='婚假' then 1 else 0 end)+sum(case when a14='婚假' then 1 else 0 end)+sum(case when a15='婚假' then 1 else 0 end)+sum(case when a16='婚假' then 1 else 0 end)+sum(case when a17='婚假' then 1 else 0 end)+sum(case when a18='婚假' then 1 else 0 end)+sum(case when a19='婚假' then 1 else 0 end)+sum(case when a20='婚假' then 1 else 0 end)+sum(case when a21='婚假' then 1 else 0 end)+sum(case when a22='婚假' then 1 else 0 end)+sum(case when a23='婚假' then 1 else 0 end)+sum(case when a24='婚假' then 1 else 0 end)+sum(case when a25='婚假' then 1 else 0 end)+sum(case when a26='婚假' then 1 else 0 end)+sum(case when a27='婚假' then 1 else 0 end)+sum(case when a28='婚假' then 1 else 0 end)+sum(case when a29='婚假' then 1 else 0 end)+sum(case when a30='婚假' then 1 else 0 end)+sum(case when a31='婚假' then 1 else 0 end) as hunjia,"
		+"sum(case when a1='旷工' then 1 else 0 end)+sum(case when a2='旷工' then 1 else 0 end)+sum(case when a3='旷工' then 1 else 0 end)+sum(case when a4='旷工' then 1 else 0 end)+sum(case when a5='旷工' then 1 else 0 end)+sum(case when a6='旷工' then 1 else 0 end)+sum(case when a7='旷工' then 1 else 0 end)+sum(case when a8='旷工' then 1 else 0 end)+sum(case when a9='旷工' then 1 else 0 end)+sum(case when a10='旷工' then 1 else 0 end)+sum(case when a11='旷工' then 1 else 0 end)+sum(case when a12='旷工' then 1 else 0 end)+sum(case when a13='旷工' then 1 else 0 end)+sum(case when a14='旷工' then 1 else 0 end)+sum(case when a15='旷工' then 1 else 0 end)+sum(case when a16='旷工' then 1 else 0 end)+sum(case when a17='旷工' then 1 else 0 end)+sum(case when a18='旷工' then 1 else 0 end)+sum(case when a19='旷工' then 1 else 0 end)+sum(case when a20='旷工' then 1 else 0 end)+sum(case when a21='旷工' then 1 else 0 end)+sum(case when a22='旷工' then 1 else 0 end)+sum(case when a23='旷工' then 1 else 0 end)+sum(case when a24='旷工' then 1 else 0 end)+sum(case when a25='旷工' then 1 else 0 end)+sum(case when a26='旷工' then 1 else 0 end)+sum(case when a27='旷工' then 1 else 0 end)+sum(case when a28='旷工' then 1 else 0 end)+sum(case when a29='旷工' then 1 else 0 end)+sum(case when a30='旷工' then 1 else 0 end)+sum(case when a31='旷工' then 1 else 0 end) as kuanggong,"
		+"sum(case when a1='迟到' then 1 else 0 end)+sum(case when a2='迟到' then 1 else 0 end)+sum(case when a3='迟到' then 1 else 0 end)+sum(case when a4='迟到' then 1 else 0 end)+sum(case when a5='迟到' then 1 else 0 end)+sum(case when a6='迟到' then 1 else 0 end)+sum(case when a7='迟到' then 1 else 0 end)+sum(case when a8='迟到' then 1 else 0 end)+sum(case when a9='迟到' then 1 else 0 end)+sum(case when a10='迟到' then 1 else 0 end)+sum(case when a11='迟到' then 1 else 0 end)+sum(case when a12='迟到' then 1 else 0 end)+sum(case when a13='迟到' then 1 else 0 end)+sum(case when a14='迟到' then 1 else 0 end)+sum(case when a15='迟到' then 1 else 0 end)+sum(case when a16='迟到' then 1 else 0 end)+sum(case when a17='迟到' then 1 else 0 end)+sum(case when a18='迟到' then 1 else 0 end)+sum(case when a19='迟到' then 1 else 0 end)+sum(case when a20='迟到' then 1 else 0 end)+sum(case when a21='迟到' then 1 else 0 end)+sum(case when a22='迟到' then 1 else 0 end)+sum(case when a23='迟到' then 1 else 0 end)+sum(case when a24='迟到' then 1 else 0 end)+sum(case when a25='迟到' then 1 else 0 end)+sum(case when a26='迟到' then 1 else 0 end)+sum(case when a27='迟到' then 1 else 0 end)+sum(case when a28='迟到' then 1 else 0 end)+sum(case when a29='迟到' then 1 else 0 end)+sum(case when a30='迟到' then 1 else 0 end)+sum(case when a31='迟到' then 1 else 0 end) as chidao,"
		+"sum(case when a1='早退' then 1 else 0 end)+sum(case when a2='早退' then 1 else 0 end)+sum(case when a3='早退' then 1 else 0 end)+sum(case when a4='早退' then 1 else 0 end)+sum(case when a5='早退' then 1 else 0 end)+sum(case when a6='早退' then 1 else 0 end)+sum(case when a7='早退' then 1 else 0 end)+sum(case when a8='早退' then 1 else 0 end)+sum(case when a9='早退' then 1 else 0 end)+sum(case when a10='早退' then 1 else 0 end)+sum(case when a11='早退' then 1 else 0 end)+sum(case when a12='早退' then 1 else 0 end)+sum(case when a13='早退' then 1 else 0 end)+sum(case when a14='早退' then 1 else 0 end)+sum(case when a15='早退' then 1 else 0 end)+sum(case when a16='早退' then 1 else 0 end)+sum(case when a17='早退' then 1 else 0 end)+sum(case when a18='早退' then 1 else 0 end)+sum(case when a19='早退' then 1 else 0 end)+sum(case when a20='早退' then 1 else 0 end)+sum(case when a21='早退' then 1 else 0 end)+sum(case when a22='早退' then 1 else 0 end)+sum(case when a23='早退' then 1 else 0 end)+sum(case when a24='早退' then 1 else 0 end)+sum(case when a25='早退' then 1 else 0 end)+sum(case when a26='早退' then 1 else 0 end)+sum(case when a27='早退' then 1 else 0 end)+sum(case when a28='早退' then 1 else 0 end)+sum(case when a29='早退' then 1 else 0 end)+sum(case when a30='早退' then 1 else 0 end)+sum(case when a31='早退' then 1 else 0 end) as zaotui,"
		+"sum(case when a1='中途离岗' then 1 else 0 end)+sum(case when a2='中途离岗' then 1 else 0 end)+sum(case when a3='中途离岗' then 1 else 0 end)+sum(case when a4='中途离岗' then 1 else 0 end)+sum(case when a5='中途离岗' then 1 else 0 end)+sum(case when a6='中途离岗' then 1 else 0 end)+sum(case when a7='中途离岗' then 1 else 0 end)+sum(case when a8='中途离岗' then 1 else 0 end)+sum(case when a9='中途离岗' then 1 else 0 end)+sum(case when a10='中途离岗' then 1 else 0 end)+sum(case when a11='中途离岗' then 1 else 0 end)+sum(case when a12='中途离岗' then 1 else 0 end)+sum(case when a13='中途离岗' then 1 else 0 end)+sum(case when a14='中途离岗' then 1 else 0 end)+sum(case when a15='中途离岗' then 1 else 0 end)+sum(case when a16='中途离岗' then 1 else 0 end)+sum(case when a17='中途离岗' then 1 else 0 end)+sum(case when a18='中途离岗' then 1 else 0 end)+sum(case when a19='中途离岗' then 1 else 0 end)+sum(case when a20='中途离岗' then 1 else 0 end)+sum(case when a21='中途离岗' then 1 else 0 end)+sum(case when a22='中途离岗' then 1 else 0 end)+sum(case when a23='中途离岗' then 1 else 0 end)+sum(case when a24='中途离岗' then 1 else 0 end)+sum(case when a25='中途离岗' then 1 else 0 end)+sum(case when a26='中途离岗' then 1 else 0 end)+sum(case when a27='中途离岗' then 1 else 0 end)+sum(case when a28='中途离岗' then 1 else 0 end)+sum(case when a29='中途离岗' then 1 else 0 end)+sum(case when a30='中途离岗' then 1 else 0 end)+sum(case when a31='中途离岗' then 1 else 0 end) as zhongtuligang,"
		+"sum(case when a1='年休假' then 1 else 0 end)+sum(case when a2='年休假' then 1 else 0 end)+sum(case when a3='年休假' then 1 else 0 end)+sum(case when a4='年休假' then 1 else 0 end)+sum(case when a5='年休假' then 1 else 0 end)+sum(case when a6='年休假' then 1 else 0 end)+sum(case when a7='年休假' then 1 else 0 end)+sum(case when a8='年休假' then 1 else 0 end)+sum(case when a9='年休假' then 1 else 0 end)+sum(case when a10='年休假' then 1 else 0 end)+sum(case when a11='年休假' then 1 else 0 end)+sum(case when a12='年休假' then 1 else 0 end)+sum(case when a13='年休假' then 1 else 0 end)+sum(case when a14='年休假' then 1 else 0 end)+sum(case when a15='年休假' then 1 else 0 end)+sum(case when a16='年休假' then 1 else 0 end)+sum(case when a17='年休假' then 1 else 0 end)+sum(case when a18='年休假' then 1 else 0 end)+sum(case when a19='年休假' then 1 else 0 end)+sum(case when a20='年休假' then 1 else 0 end)+sum(case when a21='年休假' then 1 else 0 end)+sum(case when a22='年休假' then 1 else 0 end)+sum(case when a23='年休假' then 1 else 0 end)+sum(case when a24='年休假' then 1 else 0 end)+sum(case when a25='年休假' then 1 else 0 end)+sum(case when a26='年休假' then 1 else 0 end)+sum(case when a27='年休假' then 1 else 0 end)+sum(case when a28='年休假' then 1 else 0 end)+sum(case when a29='年休假' then 1 else 0 end)+sum(case when a30='年休假' then 1 else 0 end)+sum(case when a31='年休假' then 1 else 0 end) as nianxiujia,"
		+"sum(case when a1='哺乳假' then 1 else 0 end)+sum(case when a2='哺乳假' then 1 else 0 end)+sum(case when a3='哺乳假' then 1 else 0 end)+sum(case when a4='哺乳假' then 1 else 0 end)+sum(case when a5='哺乳假' then 1 else 0 end)+sum(case when a6='哺乳假' then 1 else 0 end)+sum(case when a7='哺乳假' then 1 else 0 end)+sum(case when a8='哺乳假' then 1 else 0 end)+sum(case when a9='哺乳假' then 1 else 0 end)+sum(case when a10='哺乳假' then 1 else 0 end)+sum(case when a11='哺乳假' then 1 else 0 end)+sum(case when a12='哺乳假' then 1 else 0 end)+sum(case when a13='哺乳假' then 1 else 0 end)+sum(case when a14='哺乳假' then 1 else 0 end)+sum(case when a15='哺乳假' then 1 else 0 end)+sum(case when a16='哺乳假' then 1 else 0 end)+sum(case when a17='哺乳假' then 1 else 0 end)+sum(case when a18='哺乳假' then 1 else 0 end)+sum(case when a19='哺乳假' then 1 else 0 end)+sum(case when a20='哺乳假' then 1 else 0 end)+sum(case when a21='哺乳假' then 1 else 0 end)+sum(case when a22='哺乳假' then 1 else 0 end)+sum(case when a23='哺乳假' then 1 else 0 end)+sum(case when a24='哺乳假' then 1 else 0 end)+sum(case when a25='哺乳假' then 1 else 0 end)+sum(case when a26='哺乳假' then 1 else 0 end)+sum(case when a27='哺乳假' then 1 else 0 end)+sum(case when a28='哺乳假' then 1 else 0 end)+sum(case when a29='哺乳假' then 1 else 0 end)+sum(case when a30='哺乳假' then 1 else 0 end)+sum(case when a31='哺乳假' then 1 else 0 end) as burujia,"
		+"sum(case when a1='护理假' then 1 else 0 end)+sum(case when a2='护理假' then 1 else 0 end)+sum(case when a3='护理假' then 1 else 0 end)+sum(case when a4='护理假' then 1 else 0 end)+sum(case when a5='护理假' then 1 else 0 end)+sum(case when a6='护理假' then 1 else 0 end)+sum(case when a7='护理假' then 1 else 0 end)+sum(case when a8='护理假' then 1 else 0 end)+sum(case when a9='护理假' then 1 else 0 end)+sum(case when a10='护理假' then 1 else 0 end)+sum(case when a11='护理假' then 1 else 0 end)+sum(case when a12='护理假' then 1 else 0 end)+sum(case when a13='护理假' then 1 else 0 end)+sum(case when a14='护理假' then 1 else 0 end)+sum(case when a15='护理假' then 1 else 0 end)+sum(case when a16='护理假' then 1 else 0 end)+sum(case when a17='护理假' then 1 else 0 end)+sum(case when a18='护理假' then 1 else 0 end)+sum(case when a19='护理假' then 1 else 0 end)+sum(case when a20='护理假' then 1 else 0 end)+sum(case when a21='护理假' then 1 else 0 end)+sum(case when a22='护理假' then 1 else 0 end)+sum(case when a23='护理假' then 1 else 0 end)+sum(case when a24='护理假' then 1 else 0 end)+sum(case when a25='护理假' then 1 else 0 end)+sum(case when a26='护理假' then 1 else 0 end)+sum(case when a27='护理假' then 1 else 0 end)+sum(case when a28='护理假' then 1 else 0 end)+sum(case when a29='护理假' then 1 else 0 end)+sum(case when a30='护理假' then 1 else 0 end)+sum(case when a31='护理假' then 1 else 0 end) as hulijia,"
		+"sum(case when a1='疗养假' then 1 else 0 end)+sum(case when a2='疗养假' then 1 else 0 end)+sum(case when a3='疗养假' then 1 else 0 end)+sum(case when a4='疗养假' then 1 else 0 end)+sum(case when a5='疗养假' then 1 else 0 end)+sum(case when a6='疗养假' then 1 else 0 end)+sum(case when a7='疗养假' then 1 else 0 end)+sum(case when a8='疗养假' then 1 else 0 end)+sum(case when a9='疗养假' then 1 else 0 end)+sum(case when a10='疗养假' then 1 else 0 end)+sum(case when a11='疗养假' then 1 else 0 end)+sum(case when a12='疗养假' then 1 else 0 end)+sum(case when a13='疗养假' then 1 else 0 end)+sum(case when a14='疗养假' then 1 else 0 end)+sum(case when a15='疗养假' then 1 else 0 end)+sum(case when a16='疗养假' then 1 else 0 end)+sum(case when a17='疗养假' then 1 else 0 end)+sum(case when a18='疗养假' then 1 else 0 end)+sum(case when a19='疗养假' then 1 else 0 end)+sum(case when a20='疗养假' then 1 else 0 end)+sum(case when a21='疗养假' then 1 else 0 end)+sum(case when a22='疗养假' then 1 else 0 end)+sum(case when a23='疗养假' then 1 else 0 end)+sum(case when a24='疗养假' then 1 else 0 end)+sum(case when a25='疗养假' then 1 else 0 end)+sum(case when a26='疗养假' then 1 else 0 end)+sum(case when a27='疗养假' then 1 else 0 end)+sum(case when a28='疗养假' then 1 else 0 end)+sum(case when a29='疗养假' then 1 else 0 end)+sum(case when a30='疗养假' then 1 else 0 end)+sum(case when a31='疗养假' then 1 else 0 end) as liaoyangjia,"
		+"sum(case when a1='探亲假' then 1 else 0 end)+sum(case when a2='探亲假' then 1 else 0 end)+sum(case when a3='探亲假' then 1 else 0 end)+sum(case when a4='探亲假' then 1 else 0 end)+sum(case when a5='探亲假' then 1 else 0 end)+sum(case when a6='探亲假' then 1 else 0 end)+sum(case when a7='探亲假' then 1 else 0 end)+sum(case when a8='探亲假' then 1 else 0 end)+sum(case when a9='探亲假' then 1 else 0 end)+sum(case when a10='探亲假' then 1 else 0 end)+sum(case when a11='探亲假' then 1 else 0 end)+sum(case when a12='探亲假' then 1 else 0 end)+sum(case when a13='探亲假' then 1 else 0 end)+sum(case when a14='探亲假' then 1 else 0 end)+sum(case when a15='探亲假' then 1 else 0 end)+sum(case when a16='探亲假' then 1 else 0 end)+sum(case when a17='探亲假' then 1 else 0 end)+sum(case when a18='探亲假' then 1 else 0 end)+sum(case when a19='探亲假' then 1 else 0 end)+sum(case when a20='探亲假' then 1 else 0 end)+sum(case when a21='探亲假' then 1 else 0 end)+sum(case when a22='探亲假' then 1 else 0 end)+sum(case when a23='探亲假' then 1 else 0 end)+sum(case when a24='探亲假' then 1 else 0 end)+sum(case when a25='探亲假' then 1 else 0 end)+sum(case when a26='探亲假' then 1 else 0 end)+sum(case when a27='探亲假' then 1 else 0 end)+sum(case when a28='探亲假' then 1 else 0 end)+sum(case when a29='探亲假' then 1 else 0 end)+sum(case when a30='探亲假' then 1 else 0 end)+sum(case when a31='探亲假' then 1 else 0 end) as tanqinjia,"
		+"sum(case when a1='工伤治疗' then 1 else 0 end)+sum(case when a2='工伤治疗' then 1 else 0 end)+sum(case when a3='工伤治疗' then 1 else 0 end)+sum(case when a4='工伤治疗' then 1 else 0 end)+sum(case when a5='工伤治疗' then 1 else 0 end)+sum(case when a6='工伤治疗' then 1 else 0 end)+sum(case when a7='工伤治疗' then 1 else 0 end)+sum(case when a8='工伤治疗' then 1 else 0 end)+sum(case when a9='工伤治疗' then 1 else 0 end)+sum(case when a10='工伤治疗' then 1 else 0 end)+sum(case when a11='工伤治疗' then 1 else 0 end)+sum(case when a12='工伤治疗' then 1 else 0 end)+sum(case when a13='工伤治疗' then 1 else 0 end)+sum(case when a14='工伤治疗' then 1 else 0 end)+sum(case when a15='工伤治疗' then 1 else 0 end)+sum(case when a16='工伤治疗' then 1 else 0 end)+sum(case when a17='工伤治疗' then 1 else 0 end)+sum(case when a18='工伤治疗' then 1 else 0 end)+sum(case when a19='工伤治疗' then 1 else 0 end)+sum(case when a20='工伤治疗' then 1 else 0 end)+sum(case when a21='工伤治疗' then 1 else 0 end)+sum(case when a22='工伤治疗' then 1 else 0 end)+sum(case when a23='工伤治疗' then 1 else 0 end)+sum(case when a24='工伤治疗' then 1 else 0 end)+sum(case when a25='工伤治疗' then 1 else 0 end)+sum(case when a26='工伤治疗' then 1 else 0 end)+sum(case when a27='工伤治疗' then 1 else 0 end)+sum(case when a28='工伤治疗' then 1 else 0 end)+sum(case when a29='工伤治疗' then 1 else 0 end)+sum(case when a30='工伤治疗' then 1 else 0 end)+sum(case when a31='工伤治疗' then 1 else 0 end) as gongshangzhiliao,"
		+"sum(case when a1='自费学习' then 1 else 0 end)+sum(case when a2='自费学习' then 1 else 0 end)+sum(case when a3='自费学习' then 1 else 0 end)+sum(case when a4='自费学习' then 1 else 0 end)+sum(case when a5='自费学习' then 1 else 0 end)+sum(case when a6='自费学习' then 1 else 0 end)+sum(case when a7='自费学习' then 1 else 0 end)+sum(case when a8='自费学习' then 1 else 0 end)+sum(case when a9='自费学习' then 1 else 0 end)+sum(case when a10='自费学习' then 1 else 0 end)+sum(case when a11='自费学习' then 1 else 0 end)+sum(case when a12='自费学习' then 1 else 0 end)+sum(case when a13='自费学习' then 1 else 0 end)+sum(case when a14='自费学习' then 1 else 0 end)+sum(case when a15='自费学习' then 1 else 0 end)+sum(case when a16='自费学习' then 1 else 0 end)+sum(case when a17='自费学习' then 1 else 0 end)+sum(case when a18='自费学习' then 1 else 0 end)+sum(case when a19='自费学习' then 1 else 0 end)+sum(case when a20='自费学习' then 1 else 0 end)+sum(case when a21='自费学习' then 1 else 0 end)+sum(case when a22='自费学习' then 1 else 0 end)+sum(case when a23='自费学习' then 1 else 0 end)+sum(case when a24='自费学习' then 1 else 0 end)+sum(case when a25='自费学习' then 1 else 0 end)+sum(case when a26='自费学习' then 1 else 0 end)+sum(case when a27='自费学习' then 1 else 0 end)+sum(case when a28='自费学习' then 1 else 0 end)+sum(case when a29='自费学习' then 1 else 0 end)+sum(case when a30='自费学习' then 1 else 0 end)+sum(case when a31='自费学习' then 1 else 0 end) as zifeixuexi,"
		+"sum(case when a1='公派学习' then 1 else 0 end)+sum(case when a2='公派学习' then 1 else 0 end)+sum(case when a3='公派学习' then 1 else 0 end)+sum(case when a4='公派学习' then 1 else 0 end)+sum(case when a5='公派学习' then 1 else 0 end)+sum(case when a6='公派学习' then 1 else 0 end)+sum(case when a7='公派学习' then 1 else 0 end)+sum(case when a8='公派学习' then 1 else 0 end)+sum(case when a9='公派学习' then 1 else 0 end)+sum(case when a10='公派学习' then 1 else 0 end)+sum(case when a11='公派学习' then 1 else 0 end)+sum(case when a12='公派学习' then 1 else 0 end)+sum(case when a13='公派学习' then 1 else 0 end)+sum(case when a14='公派学习' then 1 else 0 end)+sum(case when a15='公派学习' then 1 else 0 end)+sum(case when a16='公派学习' then 1 else 0 end)+sum(case when a17='公派学习' then 1 else 0 end)+sum(case when a18='公派学习' then 1 else 0 end)+sum(case when a19='公派学习' then 1 else 0 end)+sum(case when a20='公派学习' then 1 else 0 end)+sum(case when a21='公派学习' then 1 else 0 end)+sum(case when a22='公派学习' then 1 else 0 end)+sum(case when a23='公派学习' then 1 else 0 end)+sum(case when a24='公派学习' then 1 else 0 end)+sum(case when a25='公派学习' then 1 else 0 end)+sum(case when a26='公派学习' then 1 else 0 end)+sum(case when a27='公派学习' then 1 else 0 end)+sum(case when a28='公派学习' then 1 else 0 end)+sum(case when a29='公派学习' then 1 else 0 end)+sum(case when a30='公派学习' then 1 else 0 end)+sum(case when a31='公派学习' then 1 else 0 end) as gongpaixuexi,"
		+"sum(case when a1='补休' then 1 else 0 end)+sum(case when a2='补休' then 1 else 0 end)+sum(case when a3='补休' then 1 else 0 end)+sum(case when a4='补休' then 1 else 0 end)+sum(case when a5='补休' then 1 else 0 end)+sum(case when a6='补休' then 1 else 0 end)+sum(case when a7='补休' then 1 else 0 end)+sum(case when a8='补休' then 1 else 0 end)+sum(case when a9='补休' then 1 else 0 end)+sum(case when a10='补休' then 1 else 0 end)+sum(case when a11='补休' then 1 else 0 end)+sum(case when a12='补休' then 1 else 0 end)+sum(case when a13='补休' then 1 else 0 end)+sum(case when a14='补休' then 1 else 0 end)+sum(case when a15='补休' then 1 else 0 end)+sum(case when a16='补休' then 1 else 0 end)+sum(case when a17='补休' then 1 else 0 end)+sum(case when a18='补休' then 1 else 0 end)+sum(case when a19='补休' then 1 else 0 end)+sum(case when a20='补休' then 1 else 0 end)+sum(case when a21='补休' then 1 else 0 end)+sum(case when a22='补休' then 1 else 0 end)+sum(case when a23='补休' then 1 else 0 end)+sum(case when a24='补休' then 1 else 0 end)+sum(case when a25='补休' then 1 else 0 end)+sum(case when a26='补休' then 1 else 0 end)+sum(case when a27='补休' then 1 else 0 end)+sum(case when a28='补休' then 1 else 0 end)+sum(case when a29='补休' then 1 else 0 end)+sum(case when a30='补休' then 1 else 0 end)+sum(case when a31='补休' then 1 else 0 end) as buxiu,"
		+"sum(case when a1='节日' then 1 else 0 end)+sum(case when a2='节日' then 1 else 0 end)+sum(case when a3='节日' then 1 else 0 end)+sum(case when a4='节日' then 1 else 0 end)+sum(case when a5='节日' then 1 else 0 end)+sum(case when a6='节日' then 1 else 0 end)+sum(case when a7='节日' then 1 else 0 end)+sum(case when a8='节日' then 1 else 0 end)+sum(case when a9='节日' then 1 else 0 end)+sum(case when a10='节日' then 1 else 0 end)+sum(case when a11='节日' then 1 else 0 end)+sum(case when a12='节日' then 1 else 0 end)+sum(case when a13='节日' then 1 else 0 end)+sum(case when a14='节日' then 1 else 0 end)+sum(case when a15='节日' then 1 else 0 end)+sum(case when a16='节日' then 1 else 0 end)+sum(case when a17='节日' then 1 else 0 end)+sum(case when a18='节日' then 1 else 0 end)+sum(case when a19='节日' then 1 else 0 end)+sum(case when a20='节日' then 1 else 0 end)+sum(case when a21='节日' then 1 else 0 end)+sum(case when a22='节日' then 1 else 0 end)+sum(case when a23='节日' then 1 else 0 end)+sum(case when a24='节日' then 1 else 0 end)+sum(case when a25='节日' then 1 else 0 end)+sum(case when a26='节日' then 1 else 0 end)+sum(case when a27='节日' then 1 else 0 end)+sum(case when a28='节日' then 1 else 0 end)+sum(case when a29='节日' then 1 else 0 end)+sum(case when a30='节日' then 1 else 0 end)+sum(case when a31='节日' then 1 else 0 end) as jieri,"
		+"sum(case when a1='公休' then 1 else 0 end)+sum(case when a2='公休' then 1 else 0 end)+sum(case when a3='公休' then 1 else 0 end)+sum(case when a4='公休' then 1 else 0 end)+sum(case when a5='公休' then 1 else 0 end)+sum(case when a6='公休' then 1 else 0 end)+sum(case when a7='公休' then 1 else 0 end)+sum(case when a8='公休' then 1 else 0 end)+sum(case when a9='公休' then 1 else 0 end)+sum(case when a10='公休' then 1 else 0 end)+sum(case when a11='公休' then 1 else 0 end)+sum(case when a12='公休' then 1 else 0 end)+sum(case when a13='公休' then 1 else 0 end)+sum(case when a14='公休' then 1 else 0 end)+sum(case when a15='公休' then 1 else 0 end)+sum(case when a16='公休' then 1 else 0 end)+sum(case when a17='公休' then 1 else 0 end)+sum(case when a18='公休' then 1 else 0 end)+sum(case when a19='公休' then 1 else 0 end)+sum(case when a20='公休' then 1 else 0 end)+sum(case when a21='公休' then 1 else 0 end)+sum(case when a22='公休' then 1 else 0 end)+sum(case when a23='公休' then 1 else 0 end)+sum(case when a24='公休' then 1 else 0 end)+sum(case when a25='公休' then 1 else 0 end)+sum(case when a26='公休' then 1 else 0 end)+sum(case when a27='公休' then 1 else 0 end)+sum(case when a28='公休' then 1 else 0 end)+sum(case when a29='公休' then 1 else 0 end)+sum(case when a30='公休' then 1 else 0 end)+sum(case when a31='公休' then 1 else 0 end) as gongxiu,"
		+"sum(case when a1='培训' then 1 else 0 end)+sum(case when a2='培训' then 1 else 0 end)+sum(case when a3='培训' then 1 else 0 end)+sum(case when a4='培训' then 1 else 0 end)+sum(case when a5='培训' then 1 else 0 end)+sum(case when a6='培训' then 1 else 0 end)+sum(case when a7='培训' then 1 else 0 end)+sum(case when a8='培训' then 1 else 0 end)+sum(case when a9='培训' then 1 else 0 end)+sum(case when a10='培训' then 1 else 0 end)+sum(case when a11='培训' then 1 else 0 end)+sum(case when a12='培训' then 1 else 0 end)+sum(case when a13='培训' then 1 else 0 end)+sum(case when a14='培训' then 1 else 0 end)+sum(case when a15='培训' then 1 else 0 end)+sum(case when a16='培训' then 1 else 0 end)+sum(case when a17='培训' then 1 else 0 end)+sum(case when a18='培训' then 1 else 0 end)+sum(case when a19='培训' then 1 else 0 end)+sum(case when a20='培训' then 1 else 0 end)+sum(case when a21='培训' then 1 else 0 end)+sum(case when a22='培训' then 1 else 0 end)+sum(case when a23='培训' then 1 else 0 end)+sum(case when a24='培训' then 1 else 0 end)+sum(case when a25='培训' then 1 else 0 end)+sum(case when a26='培训' then 1 else 0 end)+sum(case when a27='培训' then 1 else 0 end)+sum(case when a28='培训' then 1 else 0 end)+sum(case when a29='培训' then 1 else 0 end)+sum(case when a30='培训' then 1 else 0 end)+sum(case when a31='培训' then 1 else 0 end)"
		+"+sum(case when a1='出差' then 1 else 0 end)+sum(case when a2='出差' then 1 else 0 end)+sum(case when a3='出差' then 1 else 0 end)+sum(case when a4='出差' then 1 else 0 end)+sum(case when a5='出差' then 1 else 0 end)+sum(case when a6='出差' then 1 else 0 end)+sum(case when a7='出差' then 1 else 0 end)+sum(case when a8='出差' then 1 else 0 end)+sum(case when a9='出差' then 1 else 0 end)+sum(case when a10='出差' then 1 else 0 end)+sum(case when a11='出差' then 1 else 0 end)+sum(case when a12='出差' then 1 else 0 end)+sum(case when a13='出差' then 1 else 0 end)+sum(case when a14='出差' then 1 else 0 end)+sum(case when a15='出差' then 1 else 0 end)+sum(case when a16='出差' then 1 else 0 end)+sum(case when a17='出差' then 1 else 0 end)+sum(case when a18='出差' then 1 else 0 end)+sum(case when a19='出差' then 1 else 0 end)+sum(case when a20='出差' then 1 else 0 end)+sum(case when a21='出差' then 1 else 0 end)+sum(case when a22='出差' then 1 else 0 end)+sum(case when a23='出差' then 1 else 0 end)+sum(case when a24='出差' then 1 else 0 end)+sum(case when a25='出差' then 1 else 0 end)+sum(case when a26='出差' then 1 else 0 end)+sum(case when a27='出差' then 1 else 0 end)+sum(case when a28='出差' then 1 else 0 end)+sum(case when a29='出差' then 1 else 0 end)+sum(case when a30='出差' then 1 else 0 end)+sum(case when a31='出差' then 1 else 0 end)"
		+"+sum(case when a1='迟到' then 1 else 0 end)+sum(case when a2='迟到' then 1 else 0 end)+sum(case when a3='迟到' then 1 else 0 end)+sum(case when a4='迟到' then 1 else 0 end)+sum(case when a5='迟到' then 1 else 0 end)+sum(case when a6='迟到' then 1 else 0 end)+sum(case when a7='迟到' then 1 else 0 end)+sum(case when a8='迟到' then 1 else 0 end)+sum(case when a9='迟到' then 1 else 0 end)+sum(case when a10='迟到' then 1 else 0 end)+sum(case when a11='迟到' then 1 else 0 end)+sum(case when a12='迟到' then 1 else 0 end)+sum(case when a13='迟到' then 1 else 0 end)+sum(case when a14='迟到' then 1 else 0 end)+sum(case when a15='迟到' then 1 else 0 end)+sum(case when a16='迟到' then 1 else 0 end)+sum(case when a17='迟到' then 1 else 0 end)+sum(case when a18='迟到' then 1 else 0 end)+sum(case when a19='迟到' then 1 else 0 end)+sum(case when a20='迟到' then 1 else 0 end)+sum(case when a21='迟到' then 1 else 0 end)+sum(case when a22='迟到' then 1 else 0 end)+sum(case when a23='迟到' then 1 else 0 end)+sum(case when a24='迟到' then 1 else 0 end)+sum(case when a25='迟到' then 1 else 0 end)+sum(case when a26='迟到' then 1 else 0 end)+sum(case when a27='迟到' then 1 else 0 end)+sum(case when a28='迟到' then 1 else 0 end)+sum(case when a29='迟到' then 1 else 0 end)+sum(case when a30='迟到' then 1 else 0 end)+sum(case when a31='迟到' then 1 else 0 end)"
		+"+sum(case when a1='早退' then 1 else 0 end)+sum(case when a2='早退' then 1 else 0 end)+sum(case when a3='早退' then 1 else 0 end)+sum(case when a4='早退' then 1 else 0 end)+sum(case when a5='早退' then 1 else 0 end)+sum(case when a6='早退' then 1 else 0 end)+sum(case when a7='早退' then 1 else 0 end)+sum(case when a8='早退' then 1 else 0 end)+sum(case when a9='早退' then 1 else 0 end)+sum(case when a10='早退' then 1 else 0 end)+sum(case when a11='早退' then 1 else 0 end)+sum(case when a12='早退' then 1 else 0 end)+sum(case when a13='早退' then 1 else 0 end)+sum(case when a14='早退' then 1 else 0 end)+sum(case when a15='早退' then 1 else 0 end)+sum(case when a16='早退' then 1 else 0 end)+sum(case when a17='早退' then 1 else 0 end)+sum(case when a18='早退' then 1 else 0 end)+sum(case when a19='早退' then 1 else 0 end)+sum(case when a20='早退' then 1 else 0 end)+sum(case when a21='早退' then 1 else 0 end)+sum(case when a22='早退' then 1 else 0 end)+sum(case when a23='早退' then 1 else 0 end)+sum(case when a24='早退' then 1 else 0 end)+sum(case when a25='早退' then 1 else 0 end)+sum(case when a26='早退' then 1 else 0 end)+sum(case when a27='早退' then 1 else 0 end)+sum(case when a28='早退' then 1 else 0 end)+sum(case when a29='早退' then 1 else 0 end)+sum(case when a30='早退' then 1 else 0 end)+sum(case when a31='早退' then 1 else 0 end)"
		+"+sum(case when a1='中途离岗' then 1 else 0 end)+sum(case when a2='中途离岗' then 1 else 0 end)+sum(case when a3='中途离岗' then 1 else 0 end)+sum(case when a4='中途离岗' then 1 else 0 end)+sum(case when a5='中途离岗' then 1 else 0 end)+sum(case when a6='中途离岗' then 1 else 0 end)+sum(case when a7='中途离岗' then 1 else 0 end)+sum(case when a8='中途离岗' then 1 else 0 end)+sum(case when a9='中途离岗' then 1 else 0 end)+sum(case when a10='中途离岗' then 1 else 0 end)+sum(case when a11='中途离岗' then 1 else 0 end)+sum(case when a12='中途离岗' then 1 else 0 end)+sum(case when a13='中途离岗' then 1 else 0 end)+sum(case when a14='中途离岗' then 1 else 0 end)+sum(case when a15='中途离岗' then 1 else 0 end)+sum(case when a16='中途离岗' then 1 else 0 end)+sum(case when a17='中途离岗' then 1 else 0 end)+sum(case when a18='中途离岗' then 1 else 0 end)+sum(case when a19='中途离岗' then 1 else 0 end)+sum(case when a20='中途离岗' then 1 else 0 end)+sum(case when a21='中途离岗' then 1 else 0 end)+sum(case when a22='中途离岗' then 1 else 0 end)+sum(case when a23='中途离岗' then 1 else 0 end)+sum(case when a24='中途离岗' then 1 else 0 end)+sum(case when a25='中途离岗' then 1 else 0 end)+sum(case when a26='中途离岗' then 1 else 0 end)+sum(case when a27='中途离岗' then 1 else 0 end)+sum(case when a28='中途离岗' then 1 else 0 end)+sum(case when a29='中途离岗' then 1 else 0 end)+sum(case when a30='中途离岗' then 1 else 0 end)+sum(case when a31='中途离岗' then 1 else 0 end)"
		+"+sum(case when a1='年休假' then 1 else 0 end)+sum(case when a2='年休假' then 1 else 0 end)+sum(case when a3='年休假' then 1 else 0 end)+sum(case when a4='年休假' then 1 else 0 end)+sum(case when a5='年休假' then 1 else 0 end)+sum(case when a6='年休假' then 1 else 0 end)+sum(case when a7='年休假' then 1 else 0 end)+sum(case when a8='年休假' then 1 else 0 end)+sum(case when a9='年休假' then 1 else 0 end)+sum(case when a10='年休假' then 1 else 0 end)+sum(case when a11='年休假' then 1 else 0 end)+sum(case when a12='年休假' then 1 else 0 end)+sum(case when a13='年休假' then 1 else 0 end)+sum(case when a14='年休假' then 1 else 0 end)+sum(case when a15='年休假' then 1 else 0 end)+sum(case when a16='年休假' then 1 else 0 end)+sum(case when a17='年休假' then 1 else 0 end)+sum(case when a18='年休假' then 1 else 0 end)+sum(case when a19='年休假' then 1 else 0 end)+sum(case when a20='年休假' then 1 else 0 end)+sum(case when a21='年休假' then 1 else 0 end)+sum(case when a22='年休假' then 1 else 0 end)+sum(case when a23='年休假' then 1 else 0 end)+sum(case when a24='年休假' then 1 else 0 end)+sum(case when a25='年休假' then 1 else 0 end)+sum(case when a26='年休假' then 1 else 0 end)+sum(case when a27='年休假' then 1 else 0 end)+sum(case when a28='年休假' then 1 else 0 end)+sum(case when a29='年休假' then 1 else 0 end)+sum(case when a30='年休假' then 1 else 0 end)+sum(case when a31='年休假' then 1 else 0 end)"
		+"+sum(case when a1='出勤' then 1 else 0 end)+sum(case when a2='出勤' then 1 else 0 end)+sum(case when a3='出勤' then 1 else 0 end)+sum(case when a4='出勤' then 1 else 0 end)+sum(case when a5='出勤' then 1 else 0 end)+sum(case when a6='出勤' then 1 else 0 end)+sum(case when a7='出勤' then 1 else 0 end)+sum(case when a8='出勤' then 1 else 0 end)+sum(case when a9='出勤' then 1 else 0 end)+sum(case when a10='出勤' then 1 else 0 end)+sum(case when a11='出勤' then 1 else 0 end)+sum(case when a12='出勤' then 1 else 0 end)+sum(case when a13='出勤' then 1 else 0 end)+sum(case when a14='出勤' then 1 else 0 end)+sum(case when a15='出勤' then 1 else 0 end)+sum(case when a16='出勤' then 1 else 0 end)+sum(case when a17='出勤' then 1 else 0 end)+sum(case when a18='出勤' then 1 else 0 end)+sum(case when a19='出勤' then 1 else 0 end)+sum(case when a20='出勤' then 1 else 0 end)+sum(case when a21='出勤' then 1 else 0 end)+sum(case when a22='出勤' then 1 else 0 end)+sum(case when a23='出勤' then 1 else 0 end)+sum(case when a24='出勤' then 1 else 0 end)+sum(case when a25='出勤' then 1 else 0 end)+sum(case when a26='出勤' then 1 else 0 end)+sum(case when a27='出勤' then 1 else 0 end)+sum(case when a28='出勤' then 1 else 0 end)+sum(case when a29='出勤' then 1 else 0 end)+sum(case when a30='出勤' then 1 else 0 end)+sum(case when a31='出勤' then 1 else 0 end) as chuqin,"
		+"sum(case when a1='迟到' then 1 else 0 end)+sum(case when a2='迟到' then 1 else 0 end)+sum(case when a3='迟到' then 1 else 0 end)+sum(case when a4='迟到' then 1 else 0 end)+sum(case when a5='迟到' then 1 else 0 end)+sum(case when a6='迟到' then 1 else 0 end)+sum(case when a7='迟到' then 1 else 0 end)+sum(case when a8='迟到' then 1 else 0 end)+sum(case when a9='迟到' then 1 else 0 end)+sum(case when a10='迟到' then 1 else 0 end)+sum(case when a11='迟到' then 1 else 0 end)+sum(case when a12='迟到' then 1 else 0 end)+sum(case when a13='迟到' then 1 else 0 end)+sum(case when a14='迟到' then 1 else 0 end)+sum(case when a15='迟到' then 1 else 0 end)+sum(case when a16='迟到' then 1 else 0 end)+sum(case when a17='迟到' then 1 else 0 end)+sum(case when a18='迟到' then 1 else 0 end)+sum(case when a19='迟到' then 1 else 0 end)+sum(case when a20='迟到' then 1 else 0 end)+sum(case when a21='迟到' then 1 else 0 end)+sum(case when a22='迟到' then 1 else 0 end)+sum(case when a23='迟到' then 1 else 0 end)+sum(case when a24='迟到' then 1 else 0 end)+sum(case when a25='迟到' then 1 else 0 end)+sum(case when a26='迟到' then 1 else 0 end)+sum(case when a27='迟到' then 1 else 0 end)+sum(case when a28='迟到' then 1 else 0 end)+sum(case when a29='迟到' then 1 else 0 end)+sum(case when a30='迟到' then 1 else 0 end)+sum(case when a31='迟到' then 1 else 0 end)"
		+"+sum(case when a1='早退' then 1 else 0 end)+sum(case when a2='早退' then 1 else 0 end)+sum(case when a3='早退' then 1 else 0 end)+sum(case when a4='早退' then 1 else 0 end)+sum(case when a5='早退' then 1 else 0 end)+sum(case when a6='早退' then 1 else 0 end)+sum(case when a7='早退' then 1 else 0 end)+sum(case when a8='早退' then 1 else 0 end)+sum(case when a9='早退' then 1 else 0 end)+sum(case when a10='早退' then 1 else 0 end)+sum(case when a11='早退' then 1 else 0 end)+sum(case when a12='早退' then 1 else 0 end)+sum(case when a13='早退' then 1 else 0 end)+sum(case when a14='早退' then 1 else 0 end)+sum(case when a15='早退' then 1 else 0 end)+sum(case when a16='早退' then 1 else 0 end)+sum(case when a17='早退' then 1 else 0 end)+sum(case when a18='早退' then 1 else 0 end)+sum(case when a19='早退' then 1 else 0 end)+sum(case when a20='早退' then 1 else 0 end)+sum(case when a21='早退' then 1 else 0 end)+sum(case when a22='早退' then 1 else 0 end)+sum(case when a23='早退' then 1 else 0 end)+sum(case when a24='早退' then 1 else 0 end)+sum(case when a25='早退' then 1 else 0 end)+sum(case when a26='早退' then 1 else 0 end)+sum(case when a27='早退' then 1 else 0 end)+sum(case when a28='早退' then 1 else 0 end)+sum(case when a29='早退' then 1 else 0 end)+sum(case when a30='早退' then 1 else 0 end)+sum(case when a31='早退' then 1 else 0 end)"
		+"+sum(case when a1='中途离岗' then 1 else 0 end)+sum(case when a2='中途离岗' then 1 else 0 end)+sum(case when a3='中途离岗' then 1 else 0 end)+sum(case when a4='中途离岗' then 1 else 0 end)+sum(case when a5='中途离岗' then 1 else 0 end)+sum(case when a6='中途离岗' then 1 else 0 end)+sum(case when a7='中途离岗' then 1 else 0 end)+sum(case when a8='中途离岗' then 1 else 0 end)+sum(case when a9='中途离岗' then 1 else 0 end)+sum(case when a10='中途离岗' then 1 else 0 end)+sum(case when a11='中途离岗' then 1 else 0 end)+sum(case when a12='中途离岗' then 1 else 0 end)+sum(case when a13='中途离岗' then 1 else 0 end)+sum(case when a14='中途离岗' then 1 else 0 end)+sum(case when a15='中途离岗' then 1 else 0 end)+sum(case when a16='中途离岗' then 1 else 0 end)+sum(case when a17='中途离岗' then 1 else 0 end)+sum(case when a18='中途离岗' then 1 else 0 end)+sum(case when a19='中途离岗' then 1 else 0 end)+sum(case when a20='中途离岗' then 1 else 0 end)+sum(case when a21='中途离岗' then 1 else 0 end)+sum(case when a22='中途离岗' then 1 else 0 end)+sum(case when a23='中途离岗' then 1 else 0 end)+sum(case when a24='中途离岗' then 1 else 0 end)+sum(case when a25='中途离岗' then 1 else 0 end)+sum(case when a26='中途离岗' then 1 else 0 end)+sum(case when a27='中途离岗' then 1 else 0 end)+sum(case when a28='中途离岗' then 1 else 0 end)+sum(case when a29='中途离岗' then 1 else 0 end)+sum(case when a30='中途离岗' then 1 else 0 end)+sum(case when a31='中途离岗' then 1 else 0 end)"
		+"+sum(case when a1='出勤' then 1 else 0 end)+sum(case when a2='出勤' then 1 else 0 end)+sum(case when a3='出勤' then 1 else 0 end)+sum(case when a4='出勤' then 1 else 0 end)+sum(case when a5='出勤' then 1 else 0 end)+sum(case when a6='出勤' then 1 else 0 end)+sum(case when a7='出勤' then 1 else 0 end)+sum(case when a8='出勤' then 1 else 0 end)+sum(case when a9='出勤' then 1 else 0 end)+sum(case when a10='出勤' then 1 else 0 end)+sum(case when a11='出勤' then 1 else 0 end)+sum(case when a12='出勤' then 1 else 0 end)+sum(case when a13='出勤' then 1 else 0 end)+sum(case when a14='出勤' then 1 else 0 end)+sum(case when a15='出勤' then 1 else 0 end)+sum(case when a16='出勤' then 1 else 0 end)+sum(case when a17='出勤' then 1 else 0 end)+sum(case when a18='出勤' then 1 else 0 end)+sum(case when a19='出勤' then 1 else 0 end)+sum(case when a20='出勤' then 1 else 0 end)+sum(case when a21='出勤' then 1 else 0 end)+sum(case when a22='出勤' then 1 else 0 end)+sum(case when a23='出勤' then 1 else 0 end)+sum(case when a24='出勤' then 1 else 0 end)+sum(case when a25='出勤' then 1 else 0 end)+sum(case when a26='出勤' then 1 else 0 end)+sum(case when a27='出勤' then 1 else 0 end)+sum(case when a28='出勤' then 1 else 0 end)+sum(case when a29='出勤' then 1 else 0 end)+sum(case when a30='出勤' then 1 else 0 end)+sum(case when a31='出勤' then 1 else 0 end) as shanggangtianshu,"
		+"sum(zhong_ban) as zhongban,"
		+"sum(shen_ban) as shenban"
		+"  from vw_work where (year(attendance_date) = ? and month(attendance_date)=? and FIND_IN_SET(dept_id, getChildLst(?))) and status='2' group by name";
		String sql1="select name,deptname,emp_no,"
				+"sum(case when a1='培训' then 1 else 0 end)+sum(case when a2='培训' then 1 else 0 end)+sum(case when a3='培训' then 1 else 0 end)+sum(case when a4='培训' then 1 else 0 end)+sum(case when a5='培训' then 1 else 0 end)+sum(case when a6='培训' then 1 else 0 end)+sum(case when a7='培训' then 1 else 0 end)+sum(case when a8='培训' then 1 else 0 end)+sum(case when a9='培训' then 1 else 0 end)+sum(case when a10='培训' then 1 else 0 end)+sum(case when a11='培训' then 1 else 0 end)+sum(case when a12='培训' then 1 else 0 end)+sum(case when a13='培训' then 1 else 0 end)+sum(case when a14='培训' then 1 else 0 end)+sum(case when a15='培训' then 1 else 0 end)+sum(case when a16='培训' then 1 else 0 end)+sum(case when a17='培训' then 1 else 0 end)+sum(case when a18='培训' then 1 else 0 end)+sum(case when a19='培训' then 1 else 0 end)+sum(case when a20='培训' then 1 else 0 end)+sum(case when a21='培训' then 1 else 0 end)+sum(case when a22='培训' then 1 else 0 end)+sum(case when a23='培训' then 1 else 0 end)+sum(case when a24='培训' then 1 else 0 end)+sum(case when a25='培训' then 1 else 0 end)+sum(case when a26='培训' then 1 else 0 end)+sum(case when a27='培训' then 1 else 0 end)+sum(case when a28='培训' then 1 else 0 end)+sum(case when a29='培训' then 1 else 0 end)+sum(case when a30='培训' then 1 else 0 end)+sum(case when a31='培训' then 1 else 0 end) as peixun,"
				+"sum(case when a1='出差' then 1 else 0 end)+sum(case when a2='出差' then 1 else 0 end)+sum(case when a3='出差' then 1 else 0 end)+sum(case when a4='出差' then 1 else 0 end)+sum(case when a5='出差' then 1 else 0 end)+sum(case when a6='出差' then 1 else 0 end)+sum(case when a7='出差' then 1 else 0 end)+sum(case when a8='出差' then 1 else 0 end)+sum(case when a9='出差' then 1 else 0 end)+sum(case when a10='出差' then 1 else 0 end)+sum(case when a11='出差' then 1 else 0 end)+sum(case when a12='出差' then 1 else 0 end)+sum(case when a13='出差' then 1 else 0 end)+sum(case when a14='出差' then 1 else 0 end)+sum(case when a15='出差' then 1 else 0 end)+sum(case when a16='出差' then 1 else 0 end)+sum(case when a17='出差' then 1 else 0 end)+sum(case when a18='出差' then 1 else 0 end)+sum(case when a19='出差' then 1 else 0 end)+sum(case when a20='出差' then 1 else 0 end)+sum(case when a21='出差' then 1 else 0 end)+sum(case when a22='出差' then 1 else 0 end)+sum(case when a23='出差' then 1 else 0 end)+sum(case when a24='出差' then 1 else 0 end)+sum(case when a25='出差' then 1 else 0 end)+sum(case when a26='出差' then 1 else 0 end)+sum(case when a27='出差' then 1 else 0 end)+sum(case when a28='出差' then 1 else 0 end)+sum(case when a29='出差' then 1 else 0 end)+sum(case when a30='出差' then 1 else 0 end)+sum(case when a31='出差' then 1 else 0 end) as chuchai,"
				+"sum(case when a1='病假' then 1 else 0 end)+sum(case when a2='病假' then 1 else 0 end)+sum(case when a3='病假' then 1 else 0 end)+sum(case when a4='病假' then 1 else 0 end)+sum(case when a5='病假' then 1 else 0 end)+sum(case when a6='病假' then 1 else 0 end)+sum(case when a7='病假' then 1 else 0 end)+sum(case when a8='病假' then 1 else 0 end)+sum(case when a9='病假' then 1 else 0 end)+sum(case when a10='病假' then 1 else 0 end)+sum(case when a11='病假' then 1 else 0 end)+sum(case when a12='病假' then 1 else 0 end)+sum(case when a13='病假' then 1 else 0 end)+sum(case when a14='病假' then 1 else 0 end)+sum(case when a15='病假' then 1 else 0 end)+sum(case when a16='病假' then 1 else 0 end)+sum(case when a17='病假' then 1 else 0 end)+sum(case when a18='病假' then 1 else 0 end)+sum(case when a19='病假' then 1 else 0 end)+sum(case when a20='病假' then 1 else 0 end)+sum(case when a21='病假' then 1 else 0 end)+sum(case when a22='病假' then 1 else 0 end)+sum(case when a23='病假' then 1 else 0 end)+sum(case when a24='病假' then 1 else 0 end)+sum(case when a25='病假' then 1 else 0 end)+sum(case when a26='病假' then 1 else 0 end)+sum(case when a27='病假' then 1 else 0 end)+sum(case when a28='病假' then 1 else 0 end)+sum(case when a29='病假' then 1 else 0 end)+sum(case when a30='病假' then 1 else 0 end)+sum(case when a31='病假' then 1 else 0 end) as bingjia,"
				+"sum(case when a1='事假' then 1 else 0 end)+sum(case when a2='事假' then 1 else 0 end)+sum(case when a3='事假' then 1 else 0 end)+sum(case when a4='事假' then 1 else 0 end)+sum(case when a5='事假' then 1 else 0 end)+sum(case when a6='事假' then 1 else 0 end)+sum(case when a7='事假' then 1 else 0 end)+sum(case when a8='事假' then 1 else 0 end)+sum(case when a9='事假' then 1 else 0 end)+sum(case when a10='事假' then 1 else 0 end)+sum(case when a11='事假' then 1 else 0 end)+sum(case when a12='事假' then 1 else 0 end)+sum(case when a13='事假' then 1 else 0 end)+sum(case when a14='事假' then 1 else 0 end)+sum(case when a15='事假' then 1 else 0 end)+sum(case when a16='事假' then 1 else 0 end)+sum(case when a17='事假' then 1 else 0 end)+sum(case when a18='事假' then 1 else 0 end)+sum(case when a19='事假' then 1 else 0 end)+sum(case when a20='事假' then 1 else 0 end)+sum(case when a21='事假' then 1 else 0 end)+sum(case when a22='事假' then 1 else 0 end)+sum(case when a23='事假' then 1 else 0 end)+sum(case when a24='事假' then 1 else 0 end)+sum(case when a25='事假' then 1 else 0 end)+sum(case when a26='事假' then 1 else 0 end)+sum(case when a27='事假' then 1 else 0 end)+sum(case when a28='事假' then 1 else 0 end)+sum(case when a29='事假' then 1 else 0 end)+sum(case when a30='事假' then 1 else 0 end)+sum(case when a31='事假' then 1 else 0 end) as shijia,"
				+"sum(case when a1='婚假' then 1 else 0 end)+sum(case when a2='婚假' then 1 else 0 end)+sum(case when a3='婚假' then 1 else 0 end)+sum(case when a4='婚假' then 1 else 0 end)+sum(case when a5='婚假' then 1 else 0 end)+sum(case when a6='婚假' then 1 else 0 end)+sum(case when a7='婚假' then 1 else 0 end)+sum(case when a8='婚假' then 1 else 0 end)+sum(case when a9='婚假' then 1 else 0 end)+sum(case when a10='婚假' then 1 else 0 end)+sum(case when a11='婚假' then 1 else 0 end)+sum(case when a12='婚假' then 1 else 0 end)+sum(case when a13='婚假' then 1 else 0 end)+sum(case when a14='婚假' then 1 else 0 end)+sum(case when a15='婚假' then 1 else 0 end)+sum(case when a16='婚假' then 1 else 0 end)+sum(case when a17='婚假' then 1 else 0 end)+sum(case when a18='婚假' then 1 else 0 end)+sum(case when a19='婚假' then 1 else 0 end)+sum(case when a20='婚假' then 1 else 0 end)+sum(case when a21='婚假' then 1 else 0 end)+sum(case when a22='婚假' then 1 else 0 end)+sum(case when a23='婚假' then 1 else 0 end)+sum(case when a24='婚假' then 1 else 0 end)+sum(case when a25='婚假' then 1 else 0 end)+sum(case when a26='婚假' then 1 else 0 end)+sum(case when a27='婚假' then 1 else 0 end)+sum(case when a28='婚假' then 1 else 0 end)+sum(case when a29='婚假' then 1 else 0 end)+sum(case when a30='婚假' then 1 else 0 end)+sum(case when a31='婚假' then 1 else 0 end) as hunjia,"
				+"sum(case when a1='旷工' then 1 else 0 end)+sum(case when a2='旷工' then 1 else 0 end)+sum(case when a3='旷工' then 1 else 0 end)+sum(case when a4='旷工' then 1 else 0 end)+sum(case when a5='旷工' then 1 else 0 end)+sum(case when a6='旷工' then 1 else 0 end)+sum(case when a7='旷工' then 1 else 0 end)+sum(case when a8='旷工' then 1 else 0 end)+sum(case when a9='旷工' then 1 else 0 end)+sum(case when a10='旷工' then 1 else 0 end)+sum(case when a11='旷工' then 1 else 0 end)+sum(case when a12='旷工' then 1 else 0 end)+sum(case when a13='旷工' then 1 else 0 end)+sum(case when a14='旷工' then 1 else 0 end)+sum(case when a15='旷工' then 1 else 0 end)+sum(case when a16='旷工' then 1 else 0 end)+sum(case when a17='旷工' then 1 else 0 end)+sum(case when a18='旷工' then 1 else 0 end)+sum(case when a19='旷工' then 1 else 0 end)+sum(case when a20='旷工' then 1 else 0 end)+sum(case when a21='旷工' then 1 else 0 end)+sum(case when a22='旷工' then 1 else 0 end)+sum(case when a23='旷工' then 1 else 0 end)+sum(case when a24='旷工' then 1 else 0 end)+sum(case when a25='旷工' then 1 else 0 end)+sum(case when a26='旷工' then 1 else 0 end)+sum(case when a27='旷工' then 1 else 0 end)+sum(case when a28='旷工' then 1 else 0 end)+sum(case when a29='旷工' then 1 else 0 end)+sum(case when a30='旷工' then 1 else 0 end)+sum(case when a31='旷工' then 1 else 0 end) as kuanggong,"
				+"sum(case when a1='迟到' then 1 else 0 end)+sum(case when a2='迟到' then 1 else 0 end)+sum(case when a3='迟到' then 1 else 0 end)+sum(case when a4='迟到' then 1 else 0 end)+sum(case when a5='迟到' then 1 else 0 end)+sum(case when a6='迟到' then 1 else 0 end)+sum(case when a7='迟到' then 1 else 0 end)+sum(case when a8='迟到' then 1 else 0 end)+sum(case when a9='迟到' then 1 else 0 end)+sum(case when a10='迟到' then 1 else 0 end)+sum(case when a11='迟到' then 1 else 0 end)+sum(case when a12='迟到' then 1 else 0 end)+sum(case when a13='迟到' then 1 else 0 end)+sum(case when a14='迟到' then 1 else 0 end)+sum(case when a15='迟到' then 1 else 0 end)+sum(case when a16='迟到' then 1 else 0 end)+sum(case when a17='迟到' then 1 else 0 end)+sum(case when a18='迟到' then 1 else 0 end)+sum(case when a19='迟到' then 1 else 0 end)+sum(case when a20='迟到' then 1 else 0 end)+sum(case when a21='迟到' then 1 else 0 end)+sum(case when a22='迟到' then 1 else 0 end)+sum(case when a23='迟到' then 1 else 0 end)+sum(case when a24='迟到' then 1 else 0 end)+sum(case when a25='迟到' then 1 else 0 end)+sum(case when a26='迟到' then 1 else 0 end)+sum(case when a27='迟到' then 1 else 0 end)+sum(case when a28='迟到' then 1 else 0 end)+sum(case when a29='迟到' then 1 else 0 end)+sum(case when a30='迟到' then 1 else 0 end)+sum(case when a31='迟到' then 1 else 0 end) as chidao,"
				+"sum(case when a1='早退' then 1 else 0 end)+sum(case when a2='早退' then 1 else 0 end)+sum(case when a3='早退' then 1 else 0 end)+sum(case when a4='早退' then 1 else 0 end)+sum(case when a5='早退' then 1 else 0 end)+sum(case when a6='早退' then 1 else 0 end)+sum(case when a7='早退' then 1 else 0 end)+sum(case when a8='早退' then 1 else 0 end)+sum(case when a9='早退' then 1 else 0 end)+sum(case when a10='早退' then 1 else 0 end)+sum(case when a11='早退' then 1 else 0 end)+sum(case when a12='早退' then 1 else 0 end)+sum(case when a13='早退' then 1 else 0 end)+sum(case when a14='早退' then 1 else 0 end)+sum(case when a15='早退' then 1 else 0 end)+sum(case when a16='早退' then 1 else 0 end)+sum(case when a17='早退' then 1 else 0 end)+sum(case when a18='早退' then 1 else 0 end)+sum(case when a19='早退' then 1 else 0 end)+sum(case when a20='早退' then 1 else 0 end)+sum(case when a21='早退' then 1 else 0 end)+sum(case when a22='早退' then 1 else 0 end)+sum(case when a23='早退' then 1 else 0 end)+sum(case when a24='早退' then 1 else 0 end)+sum(case when a25='早退' then 1 else 0 end)+sum(case when a26='早退' then 1 else 0 end)+sum(case when a27='早退' then 1 else 0 end)+sum(case when a28='早退' then 1 else 0 end)+sum(case when a29='早退' then 1 else 0 end)+sum(case when a30='早退' then 1 else 0 end)+sum(case when a31='早退' then 1 else 0 end) as zaotui,"
				+"sum(case when a1='中途离岗' then 1 else 0 end)+sum(case when a2='中途离岗' then 1 else 0 end)+sum(case when a3='中途离岗' then 1 else 0 end)+sum(case when a4='中途离岗' then 1 else 0 end)+sum(case when a5='中途离岗' then 1 else 0 end)+sum(case when a6='中途离岗' then 1 else 0 end)+sum(case when a7='中途离岗' then 1 else 0 end)+sum(case when a8='中途离岗' then 1 else 0 end)+sum(case when a9='中途离岗' then 1 else 0 end)+sum(case when a10='中途离岗' then 1 else 0 end)+sum(case when a11='中途离岗' then 1 else 0 end)+sum(case when a12='中途离岗' then 1 else 0 end)+sum(case when a13='中途离岗' then 1 else 0 end)+sum(case when a14='中途离岗' then 1 else 0 end)+sum(case when a15='中途离岗' then 1 else 0 end)+sum(case when a16='中途离岗' then 1 else 0 end)+sum(case when a17='中途离岗' then 1 else 0 end)+sum(case when a18='中途离岗' then 1 else 0 end)+sum(case when a19='中途离岗' then 1 else 0 end)+sum(case when a20='中途离岗' then 1 else 0 end)+sum(case when a21='中途离岗' then 1 else 0 end)+sum(case when a22='中途离岗' then 1 else 0 end)+sum(case when a23='中途离岗' then 1 else 0 end)+sum(case when a24='中途离岗' then 1 else 0 end)+sum(case when a25='中途离岗' then 1 else 0 end)+sum(case when a26='中途离岗' then 1 else 0 end)+sum(case when a27='中途离岗' then 1 else 0 end)+sum(case when a28='中途离岗' then 1 else 0 end)+sum(case when a29='中途离岗' then 1 else 0 end)+sum(case when a30='中途离岗' then 1 else 0 end)+sum(case when a31='中途离岗' then 1 else 0 end) as zhongtuligang,"
				+"sum(case when a1='轮休假' then 1 else 0 end)+sum(case when a2='轮休假' then 1 else 0 end)+sum(case when a3='轮休假' then 1 else 0 end)+sum(case when a4='轮休假' then 1 else 0 end)+sum(case when a5='轮休假' then 1 else 0 end)+sum(case when a6='轮休假' then 1 else 0 end)+sum(case when a7='轮休假' then 1 else 0 end)+sum(case when a8='轮休假' then 1 else 0 end)+sum(case when a9='轮休假' then 1 else 0 end)+sum(case when a10='轮休假' then 1 else 0 end)+sum(case when a11='轮休假' then 1 else 0 end)+sum(case when a12='轮休假' then 1 else 0 end)+sum(case when a13='轮休假' then 1 else 0 end)+sum(case when a14='轮休假' then 1 else 0 end)+sum(case when a15='轮休假' then 1 else 0 end)+sum(case when a16='轮休假' then 1 else 0 end)+sum(case when a17='轮休假' then 1 else 0 end)+sum(case when a18='轮休假' then 1 else 0 end)+sum(case when a19='轮休假' then 1 else 0 end)+sum(case when a20='轮休假' then 1 else 0 end)+sum(case when a21='轮休假' then 1 else 0 end)+sum(case when a22='轮休假' then 1 else 0 end)+sum(case when a23='轮休假' then 1 else 0 end)+sum(case when a24='轮休假' then 1 else 0 end)+sum(case when a25='轮休假' then 1 else 0 end)+sum(case when a26='轮休假' then 1 else 0 end)+sum(case when a27='轮休假' then 1 else 0 end)+sum(case when a28='轮休假' then 1 else 0 end)+sum(case when a29='轮休假' then 1 else 0 end)+sum(case when a30='轮休假' then 1 else 0 end)+sum(case when a31='轮休假' then 1 else 0 end) as lunxiujia,"
				+"sum(case when a1='哺乳假' then 1 else 0 end)+sum(case when a2='哺乳假' then 1 else 0 end)+sum(case when a3='哺乳假' then 1 else 0 end)+sum(case when a4='哺乳假' then 1 else 0 end)+sum(case when a5='哺乳假' then 1 else 0 end)+sum(case when a6='哺乳假' then 1 else 0 end)+sum(case when a7='哺乳假' then 1 else 0 end)+sum(case when a8='哺乳假' then 1 else 0 end)+sum(case when a9='哺乳假' then 1 else 0 end)+sum(case when a10='哺乳假' then 1 else 0 end)+sum(case when a11='哺乳假' then 1 else 0 end)+sum(case when a12='哺乳假' then 1 else 0 end)+sum(case when a13='哺乳假' then 1 else 0 end)+sum(case when a14='哺乳假' then 1 else 0 end)+sum(case when a15='哺乳假' then 1 else 0 end)+sum(case when a16='哺乳假' then 1 else 0 end)+sum(case when a17='哺乳假' then 1 else 0 end)+sum(case when a18='哺乳假' then 1 else 0 end)+sum(case when a19='哺乳假' then 1 else 0 end)+sum(case when a20='哺乳假' then 1 else 0 end)+sum(case when a21='哺乳假' then 1 else 0 end)+sum(case when a22='哺乳假' then 1 else 0 end)+sum(case when a23='哺乳假' then 1 else 0 end)+sum(case when a24='哺乳假' then 1 else 0 end)+sum(case when a25='哺乳假' then 1 else 0 end)+sum(case when a26='哺乳假' then 1 else 0 end)+sum(case when a27='哺乳假' then 1 else 0 end)+sum(case when a28='哺乳假' then 1 else 0 end)+sum(case when a29='哺乳假' then 1 else 0 end)+sum(case when a30='哺乳假' then 1 else 0 end)+sum(case when a31='哺乳假' then 1 else 0 end) as burujia,"
				+"sum(case when a1='护理假' then 1 else 0 end)+sum(case when a2='护理假' then 1 else 0 end)+sum(case when a3='护理假' then 1 else 0 end)+sum(case when a4='护理假' then 1 else 0 end)+sum(case when a5='护理假' then 1 else 0 end)+sum(case when a6='护理假' then 1 else 0 end)+sum(case when a7='护理假' then 1 else 0 end)+sum(case when a8='护理假' then 1 else 0 end)+sum(case when a9='护理假' then 1 else 0 end)+sum(case when a10='护理假' then 1 else 0 end)+sum(case when a11='护理假' then 1 else 0 end)+sum(case when a12='护理假' then 1 else 0 end)+sum(case when a13='护理假' then 1 else 0 end)+sum(case when a14='护理假' then 1 else 0 end)+sum(case when a15='护理假' then 1 else 0 end)+sum(case when a16='护理假' then 1 else 0 end)+sum(case when a17='护理假' then 1 else 0 end)+sum(case when a18='护理假' then 1 else 0 end)+sum(case when a19='护理假' then 1 else 0 end)+sum(case when a20='护理假' then 1 else 0 end)+sum(case when a21='护理假' then 1 else 0 end)+sum(case when a22='护理假' then 1 else 0 end)+sum(case when a23='护理假' then 1 else 0 end)+sum(case when a24='护理假' then 1 else 0 end)+sum(case when a25='护理假' then 1 else 0 end)+sum(case when a26='护理假' then 1 else 0 end)+sum(case when a27='护理假' then 1 else 0 end)+sum(case when a28='护理假' then 1 else 0 end)+sum(case when a29='护理假' then 1 else 0 end)+sum(case when a30='护理假' then 1 else 0 end)+sum(case when a31='护理假' then 1 else 0 end) as hulijia,"
				+"sum(case when a1='疗养假' then 1 else 0 end)+sum(case when a2='疗养假' then 1 else 0 end)+sum(case when a3='疗养假' then 1 else 0 end)+sum(case when a4='疗养假' then 1 else 0 end)+sum(case when a5='疗养假' then 1 else 0 end)+sum(case when a6='疗养假' then 1 else 0 end)+sum(case when a7='疗养假' then 1 else 0 end)+sum(case when a8='疗养假' then 1 else 0 end)+sum(case when a9='疗养假' then 1 else 0 end)+sum(case when a10='疗养假' then 1 else 0 end)+sum(case when a11='疗养假' then 1 else 0 end)+sum(case when a12='疗养假' then 1 else 0 end)+sum(case when a13='疗养假' then 1 else 0 end)+sum(case when a14='疗养假' then 1 else 0 end)+sum(case when a15='疗养假' then 1 else 0 end)+sum(case when a16='疗养假' then 1 else 0 end)+sum(case when a17='疗养假' then 1 else 0 end)+sum(case when a18='疗养假' then 1 else 0 end)+sum(case when a19='疗养假' then 1 else 0 end)+sum(case when a20='疗养假' then 1 else 0 end)+sum(case when a21='疗养假' then 1 else 0 end)+sum(case when a22='疗养假' then 1 else 0 end)+sum(case when a23='疗养假' then 1 else 0 end)+sum(case when a24='疗养假' then 1 else 0 end)+sum(case when a25='疗养假' then 1 else 0 end)+sum(case when a26='疗养假' then 1 else 0 end)+sum(case when a27='疗养假' then 1 else 0 end)+sum(case when a28='疗养假' then 1 else 0 end)+sum(case when a29='疗养假' then 1 else 0 end)+sum(case when a30='疗养假' then 1 else 0 end)+sum(case when a31='疗养假' then 1 else 0 end) as liaoyangjia,"
				+"sum(case when a1='探亲假' then 1 else 0 end)+sum(case when a2='探亲假' then 1 else 0 end)+sum(case when a3='探亲假' then 1 else 0 end)+sum(case when a4='探亲假' then 1 else 0 end)+sum(case when a5='探亲假' then 1 else 0 end)+sum(case when a6='探亲假' then 1 else 0 end)+sum(case when a7='探亲假' then 1 else 0 end)+sum(case when a8='探亲假' then 1 else 0 end)+sum(case when a9='探亲假' then 1 else 0 end)+sum(case when a10='探亲假' then 1 else 0 end)+sum(case when a11='探亲假' then 1 else 0 end)+sum(case when a12='探亲假' then 1 else 0 end)+sum(case when a13='探亲假' then 1 else 0 end)+sum(case when a14='探亲假' then 1 else 0 end)+sum(case when a15='探亲假' then 1 else 0 end)+sum(case when a16='探亲假' then 1 else 0 end)+sum(case when a17='探亲假' then 1 else 0 end)+sum(case when a18='探亲假' then 1 else 0 end)+sum(case when a19='探亲假' then 1 else 0 end)+sum(case when a20='探亲假' then 1 else 0 end)+sum(case when a21='探亲假' then 1 else 0 end)+sum(case when a22='探亲假' then 1 else 0 end)+sum(case when a23='探亲假' then 1 else 0 end)+sum(case when a24='探亲假' then 1 else 0 end)+sum(case when a25='探亲假' then 1 else 0 end)+sum(case when a26='探亲假' then 1 else 0 end)+sum(case when a27='探亲假' then 1 else 0 end)+sum(case when a28='探亲假' then 1 else 0 end)+sum(case when a29='探亲假' then 1 else 0 end)+sum(case when a30='探亲假' then 1 else 0 end)+sum(case when a31='探亲假' then 1 else 0 end) as tanqinjia,"
//				+"sum(case when a1='补休' then 1 else 0 end)+sum(case when a2='补休' then 1 else 0 end)+sum(case when a3='补休' then 1 else 0 end)+sum(case when a4='补休' then 1 else 0 end)+sum(case when a5='补休' then 1 else 0 end)+sum(case when a6='补休' then 1 else 0 end)+sum(case when a7='补休' then 1 else 0 end)+sum(case when a8='补休' then 1 else 0 end)+sum(case when a9='补休' then 1 else 0 end)+sum(case when a10='补休' then 1 else 0 end)+sum(case when a11='补休' then 1 else 0 end)+sum(case when a12='补休' then 1 else 0 end)+sum(case when a13='补休' then 1 else 0 end)+sum(case when a14='补休' then 1 else 0 end)+sum(case when a15='补休' then 1 else 0 end)+sum(case when a16='补休' then 1 else 0 end)+sum(case when a17='补休' then 1 else 0 end)+sum(case when a18='补休' then 1 else 0 end)+sum(case when a19='补休' then 1 else 0 end)+sum(case when a20='补休' then 1 else 0 end)+sum(case when a21='补休' then 1 else 0 end)+sum(case when a22='补休' then 1 else 0 end)+sum(case when a23='补休' then 1 else 0 end)+sum(case when a24='补休' then 1 else 0 end)+sum(case when a25='补休' then 1 else 0 end)+sum(case when a26='补休' then 1 else 0 end)+sum(case when a27='补休' then 1 else 0 end)+sum(case when a28='补休' then 1 else 0 end)+sum(case when a29='补休' then 1 else 0 end)+sum(case when a30='补休' then 1 else 0 end)+sum(case when a31='补休' then 1 else 0 end) as buxiu,"
				+"sum(case when a1='节日加班' then 1 else 0 end)+sum(case when a2='节日加班' then 1 else 0 end)+sum(case when a3='节日加班' then 1 else 0 end)+sum(case when a4='节日加班' then 1 else 0 end)+sum(case when a5='节日加班' then 1 else 0 end)+sum(case when a6='节日加班' then 1 else 0 end)+sum(case when a7='节日加班' then 1 else 0 end)+sum(case when a8='节日加班' then 1 else 0 end)+sum(case when a9='节日加班' then 1 else 0 end)+sum(case when a10='节日加班' then 1 else 0 end)+sum(case when a11='节日加班' then 1 else 0 end)+sum(case when a12='节日加班' then 1 else 0 end)+sum(case when a13='节日加班' then 1 else 0 end)+sum(case when a14='节日加班' then 1 else 0 end)+sum(case when a15='节日加班' then 1 else 0 end)+sum(case when a16='节日加班' then 1 else 0 end)+sum(case when a17='节日加班' then 1 else 0 end)+sum(case when a18='节日加班' then 1 else 0 end)+sum(case when a19='节日加班' then 1 else 0 end)+sum(case when a20='节日加班' then 1 else 0 end)+sum(case when a21='节日加班' then 1 else 0 end)+sum(case when a22='节日加班' then 1 else 0 end)+sum(case when a23='节日加班' then 1 else 0 end)+sum(case when a24='节日加班' then 1 else 0 end)+sum(case when a25='节日加班' then 1 else 0 end)+sum(case when a26='节日加班' then 1 else 0 end)+sum(case when a27='节日加班' then 1 else 0 end)+sum(case when a28='节日加班' then 1 else 0 end)+sum(case when a29='节日加班' then 1 else 0 end)+sum(case when a30='节日加班' then 1 else 0 end)+sum(case when a31='节日加班' then 1 else 0 end) as jieri,"
				+"sum(case when a1='公休加班' then 1 else 0 end)+sum(case when a2='公休加班' then 1 else 0 end)+sum(case when a3='公休加班' then 1 else 0 end)+sum(case when a4='公休加班' then 1 else 0 end)+sum(case when a5='公休加班' then 1 else 0 end)+sum(case when a6='公休加班' then 1 else 0 end)+sum(case when a7='公休加班' then 1 else 0 end)+sum(case when a8='公休加班' then 1 else 0 end)+sum(case when a9='公休加班' then 1 else 0 end)+sum(case when a10='公休加班' then 1 else 0 end)+sum(case when a11='公休加班' then 1 else 0 end)+sum(case when a12='公休加班' then 1 else 0 end)+sum(case when a13='公休加班' then 1 else 0 end)+sum(case when a14='公休加班' then 1 else 0 end)+sum(case when a15='公休加班' then 1 else 0 end)+sum(case when a16='公休加班' then 1 else 0 end)+sum(case when a17='公休加班' then 1 else 0 end)+sum(case when a18='公休加班' then 1 else 0 end)+sum(case when a19='公休加班' then 1 else 0 end)+sum(case when a20='公休加班' then 1 else 0 end)+sum(case when a21='公休加班' then 1 else 0 end)+sum(case when a22='公休加班' then 1 else 0 end)+sum(case when a23='公休加班' then 1 else 0 end)+sum(case when a24='公休加班' then 1 else 0 end)+sum(case when a25='公休加班' then 1 else 0 end)+sum(case when a26='公休加班' then 1 else 0 end)+sum(case when a27='公休加班' then 1 else 0 end)+sum(case when a28='公休加班' then 1 else 0 end)+sum(case when a29='公休加班' then 1 else 0 end)+sum(case when a30='公休加班' then 1 else 0 end)+sum(case when a31='公休加班' then 1 else 0 end) as gongxiu,"
				+"sum(case when a1='培训' then 1 else 0 end)+sum(case when a2='培训' then 1 else 0 end)+sum(case when a3='培训' then 1 else 0 end)+sum(case when a4='培训' then 1 else 0 end)+sum(case when a5='培训' then 1 else 0 end)+sum(case when a6='培训' then 1 else 0 end)+sum(case when a7='培训' then 1 else 0 end)+sum(case when a8='培训' then 1 else 0 end)+sum(case when a9='培训' then 1 else 0 end)+sum(case when a10='培训' then 1 else 0 end)+sum(case when a11='培训' then 1 else 0 end)+sum(case when a12='培训' then 1 else 0 end)+sum(case when a13='培训' then 1 else 0 end)+sum(case when a14='培训' then 1 else 0 end)+sum(case when a15='培训' then 1 else 0 end)+sum(case when a16='培训' then 1 else 0 end)+sum(case when a17='培训' then 1 else 0 end)+sum(case when a18='培训' then 1 else 0 end)+sum(case when a19='培训' then 1 else 0 end)+sum(case when a20='培训' then 1 else 0 end)+sum(case when a21='培训' then 1 else 0 end)+sum(case when a22='培训' then 1 else 0 end)+sum(case when a23='培训' then 1 else 0 end)+sum(case when a24='培训' then 1 else 0 end)+sum(case when a25='培训' then 1 else 0 end)+sum(case when a26='培训' then 1 else 0 end)+sum(case when a27='培训' then 1 else 0 end)+sum(case when a28='培训' then 1 else 0 end)+sum(case when a29='培训' then 1 else 0 end)+sum(case when a30='培训' then 1 else 0 end)+sum(case when a31='培训' then 1 else 0 end)"
				+"+sum(case when a1='出差' then 1 else 0 end)+sum(case when a2='出差' then 1 else 0 end)+sum(case when a3='出差' then 1 else 0 end)+sum(case when a4='出差' then 1 else 0 end)+sum(case when a5='出差' then 1 else 0 end)+sum(case when a6='出差' then 1 else 0 end)+sum(case when a7='出差' then 1 else 0 end)+sum(case when a8='出差' then 1 else 0 end)+sum(case when a9='出差' then 1 else 0 end)+sum(case when a10='出差' then 1 else 0 end)+sum(case when a11='出差' then 1 else 0 end)+sum(case when a12='出差' then 1 else 0 end)+sum(case when a13='出差' then 1 else 0 end)+sum(case when a14='出差' then 1 else 0 end)+sum(case when a15='出差' then 1 else 0 end)+sum(case when a16='出差' then 1 else 0 end)+sum(case when a17='出差' then 1 else 0 end)+sum(case when a18='出差' then 1 else 0 end)+sum(case when a19='出差' then 1 else 0 end)+sum(case when a20='出差' then 1 else 0 end)+sum(case when a21='出差' then 1 else 0 end)+sum(case when a22='出差' then 1 else 0 end)+sum(case when a23='出差' then 1 else 0 end)+sum(case when a24='出差' then 1 else 0 end)+sum(case when a25='出差' then 1 else 0 end)+sum(case when a26='出差' then 1 else 0 end)+sum(case when a27='出差' then 1 else 0 end)+sum(case when a28='出差' then 1 else 0 end)+sum(case when a29='出差' then 1 else 0 end)+sum(case when a30='出差' then 1 else 0 end)+sum(case when a31='出差' then 1 else 0 end)"
				+"+sum(case when a1='迟到' then 1 else 0 end)+sum(case when a2='迟到' then 1 else 0 end)+sum(case when a3='迟到' then 1 else 0 end)+sum(case when a4='迟到' then 1 else 0 end)+sum(case when a5='迟到' then 1 else 0 end)+sum(case when a6='迟到' then 1 else 0 end)+sum(case when a7='迟到' then 1 else 0 end)+sum(case when a8='迟到' then 1 else 0 end)+sum(case when a9='迟到' then 1 else 0 end)+sum(case when a10='迟到' then 1 else 0 end)+sum(case when a11='迟到' then 1 else 0 end)+sum(case when a12='迟到' then 1 else 0 end)+sum(case when a13='迟到' then 1 else 0 end)+sum(case when a14='迟到' then 1 else 0 end)+sum(case when a15='迟到' then 1 else 0 end)+sum(case when a16='迟到' then 1 else 0 end)+sum(case when a17='迟到' then 1 else 0 end)+sum(case when a18='迟到' then 1 else 0 end)+sum(case when a19='迟到' then 1 else 0 end)+sum(case when a20='迟到' then 1 else 0 end)+sum(case when a21='迟到' then 1 else 0 end)+sum(case when a22='迟到' then 1 else 0 end)+sum(case when a23='迟到' then 1 else 0 end)+sum(case when a24='迟到' then 1 else 0 end)+sum(case when a25='迟到' then 1 else 0 end)+sum(case when a26='迟到' then 1 else 0 end)+sum(case when a27='迟到' then 1 else 0 end)+sum(case when a28='迟到' then 1 else 0 end)+sum(case when a29='迟到' then 1 else 0 end)+sum(case when a30='迟到' then 1 else 0 end)+sum(case when a31='迟到' then 1 else 0 end)"
				+"+sum(case when a1='早退' then 1 else 0 end)+sum(case when a2='早退' then 1 else 0 end)+sum(case when a3='早退' then 1 else 0 end)+sum(case when a4='早退' then 1 else 0 end)+sum(case when a5='早退' then 1 else 0 end)+sum(case when a6='早退' then 1 else 0 end)+sum(case when a7='早退' then 1 else 0 end)+sum(case when a8='早退' then 1 else 0 end)+sum(case when a9='早退' then 1 else 0 end)+sum(case when a10='早退' then 1 else 0 end)+sum(case when a11='早退' then 1 else 0 end)+sum(case when a12='早退' then 1 else 0 end)+sum(case when a13='早退' then 1 else 0 end)+sum(case when a14='早退' then 1 else 0 end)+sum(case when a15='早退' then 1 else 0 end)+sum(case when a16='早退' then 1 else 0 end)+sum(case when a17='早退' then 1 else 0 end)+sum(case when a18='早退' then 1 else 0 end)+sum(case when a19='早退' then 1 else 0 end)+sum(case when a20='早退' then 1 else 0 end)+sum(case when a21='早退' then 1 else 0 end)+sum(case when a22='早退' then 1 else 0 end)+sum(case when a23='早退' then 1 else 0 end)+sum(case when a24='早退' then 1 else 0 end)+sum(case when a25='早退' then 1 else 0 end)+sum(case when a26='早退' then 1 else 0 end)+sum(case when a27='早退' then 1 else 0 end)+sum(case when a28='早退' then 1 else 0 end)+sum(case when a29='早退' then 1 else 0 end)+sum(case when a30='早退' then 1 else 0 end)+sum(case when a31='早退' then 1 else 0 end)"
				+"+sum(case when a1='中途离岗' then 1 else 0 end)+sum(case when a2='中途离岗' then 1 else 0 end)+sum(case when a3='中途离岗' then 1 else 0 end)+sum(case when a4='中途离岗' then 1 else 0 end)+sum(case when a5='中途离岗' then 1 else 0 end)+sum(case when a6='中途离岗' then 1 else 0 end)+sum(case when a7='中途离岗' then 1 else 0 end)+sum(case when a8='中途离岗' then 1 else 0 end)+sum(case when a9='中途离岗' then 1 else 0 end)+sum(case when a10='中途离岗' then 1 else 0 end)+sum(case when a11='中途离岗' then 1 else 0 end)+sum(case when a12='中途离岗' then 1 else 0 end)+sum(case when a13='中途离岗' then 1 else 0 end)+sum(case when a14='中途离岗' then 1 else 0 end)+sum(case when a15='中途离岗' then 1 else 0 end)+sum(case when a16='中途离岗' then 1 else 0 end)+sum(case when a17='中途离岗' then 1 else 0 end)+sum(case when a18='中途离岗' then 1 else 0 end)+sum(case when a19='中途离岗' then 1 else 0 end)+sum(case when a20='中途离岗' then 1 else 0 end)+sum(case when a21='中途离岗' then 1 else 0 end)+sum(case when a22='中途离岗' then 1 else 0 end)+sum(case when a23='中途离岗' then 1 else 0 end)+sum(case when a24='中途离岗' then 1 else 0 end)+sum(case when a25='中途离岗' then 1 else 0 end)+sum(case when a26='中途离岗' then 1 else 0 end)+sum(case when a27='中途离岗' then 1 else 0 end)+sum(case when a28='中途离岗' then 1 else 0 end)+sum(case when a29='中途离岗' then 1 else 0 end)+sum(case when a30='中途离岗' then 1 else 0 end)+sum(case when a31='中途离岗' then 1 else 0 end)"
				+"+sum(case when a1='轮休假' then 1 else 0 end)+sum(case when a2='轮休假' then 1 else 0 end)+sum(case when a3='轮休假' then 1 else 0 end)+sum(case when a4='轮休假' then 1 else 0 end)+sum(case when a5='轮休假' then 1 else 0 end)+sum(case when a6='轮休假' then 1 else 0 end)+sum(case when a7='轮休假' then 1 else 0 end)+sum(case when a8='轮休假' then 1 else 0 end)+sum(case when a9='轮休假' then 1 else 0 end)+sum(case when a10='轮休假' then 1 else 0 end)+sum(case when a11='轮休假' then 1 else 0 end)+sum(case when a12='轮休假' then 1 else 0 end)+sum(case when a13='轮休假' then 1 else 0 end)+sum(case when a14='轮休假' then 1 else 0 end)+sum(case when a15='轮休假' then 1 else 0 end)+sum(case when a16='轮休假' then 1 else 0 end)+sum(case when a17='轮休假' then 1 else 0 end)+sum(case when a18='轮休假' then 1 else 0 end)+sum(case when a19='轮休假' then 1 else 0 end)+sum(case when a20='轮休假' then 1 else 0 end)+sum(case when a21='轮休假' then 1 else 0 end)+sum(case when a22='轮休假' then 1 else 0 end)+sum(case when a23='轮休假' then 1 else 0 end)+sum(case when a24='轮休假' then 1 else 0 end)+sum(case when a25='轮休假' then 1 else 0 end)+sum(case when a26='轮休假' then 1 else 0 end)+sum(case when a27='轮休假' then 1 else 0 end)+sum(case when a28='轮休假' then 1 else 0 end)+sum(case when a29='轮休假' then 1 else 0 end)+sum(case when a30='轮休假' then 1 else 0 end)+sum(case when a31='轮休假' then 1 else 0 end)"
				+"+sum(case when a1='上井' then 1 else 0 end)+sum(case when a2='上井' then 1 else 0 end)+sum(case when a3='上井' then 1 else 0 end)+sum(case when a4='上井' then 1 else 0 end)+sum(case when a5='上井' then 1 else 0 end)+sum(case when a6='上井' then 1 else 0 end)+sum(case when a7='上井' then 1 else 0 end)+sum(case when a8='上井' then 1 else 0 end)+sum(case when a9='上井' then 1 else 0 end)+sum(case when a10='上井' then 1 else 0 end)+sum(case when a11='上井' then 1 else 0 end)+sum(case when a12='上井' then 1 else 0 end)+sum(case when a13='上井' then 1 else 0 end)+sum(case when a14='上井' then 1 else 0 end)+sum(case when a15='上井' then 1 else 0 end)+sum(case when a16='上井' then 1 else 0 end)+sum(case when a17='上井' then 1 else 0 end)+sum(case when a18='上井' then 1 else 0 end)+sum(case when a19='上井' then 1 else 0 end)+sum(case when a20='上井' then 1 else 0 end)+sum(case when a21='上井' then 1 else 0 end)+sum(case when a22='上井' then 1 else 0 end)+sum(case when a23='上井' then 1 else 0 end)+sum(case when a24='上井' then 1 else 0 end)+sum(case when a25='上井' then 1 else 0 end)+sum(case when a26='上井' then 1 else 0 end)+sum(case when a27='上井' then 1 else 0 end)+sum(case when a28='上井' then 1 else 0 end)+sum(case when a29='上井' then 1 else 0 end)+sum(case when a30='上井' then 1 else 0 end)+sum(case when a31='上井' then 1 else 0 end)"
				+"+sum(case when a1='待岗' then 1 else 0 end)+sum(case when a2='待岗' then 1 else 0 end)+sum(case when a3='待岗' then 1 else 0 end)+sum(case when a4='待岗' then 1 else 0 end)+sum(case when a5='待岗' then 1 else 0 end)+sum(case when a6='待岗' then 1 else 0 end)+sum(case when a7='待岗' then 1 else 0 end)+sum(case when a8='待岗' then 1 else 0 end)+sum(case when a9='待岗' then 1 else 0 end)+sum(case when a10='待岗' then 1 else 0 end)+sum(case when a11='待岗' then 1 else 0 end)+sum(case when a12='待岗' then 1 else 0 end)+sum(case when a13='待岗' then 1 else 0 end)+sum(case when a14='待岗' then 1 else 0 end)+sum(case when a15='待岗' then 1 else 0 end)+sum(case when a16='待岗' then 1 else 0 end)+sum(case when a17='待岗' then 1 else 0 end)+sum(case when a18='待岗' then 1 else 0 end)+sum(case when a19='待岗' then 1 else 0 end)+sum(case when a20='待岗' then 1 else 0 end)+sum(case when a21='待岗' then 1 else 0 end)+sum(case when a22='待岗' then 1 else 0 end)+sum(case when a23='待岗' then 1 else 0 end)+sum(case when a24='待岗' then 1 else 0 end)+sum(case when a25='待岗' then 1 else 0 end)+sum(case when a26='待岗' then 1 else 0 end)+sum(case when a27='待岗' then 1 else 0 end)+sum(case when a28='待岗' then 1 else 0 end)+sum(case when a29='待岗' then 1 else 0 end)+sum(case when a30='待岗' then 1 else 0 end)+sum(case when a31='待岗' then 1 else 0 end)"
				+"+sum(case when a1='出勤' then 1 else 0 end)+sum(case when a2='出勤' then 1 else 0 end)+sum(case when a3='出勤' then 1 else 0 end)+sum(case when a4='出勤' then 1 else 0 end)+sum(case when a5='出勤' then 1 else 0 end)+sum(case when a6='出勤' then 1 else 0 end)+sum(case when a7='出勤' then 1 else 0 end)+sum(case when a8='出勤' then 1 else 0 end)+sum(case when a9='出勤' then 1 else 0 end)+sum(case when a10='出勤' then 1 else 0 end)+sum(case when a11='出勤' then 1 else 0 end)+sum(case when a12='出勤' then 1 else 0 end)+sum(case when a13='出勤' then 1 else 0 end)+sum(case when a14='出勤' then 1 else 0 end)+sum(case when a15='出勤' then 1 else 0 end)+sum(case when a16='出勤' then 1 else 0 end)+sum(case when a17='出勤' then 1 else 0 end)+sum(case when a18='出勤' then 1 else 0 end)+sum(case when a19='出勤' then 1 else 0 end)+sum(case when a20='出勤' then 1 else 0 end)+sum(case when a21='出勤' then 1 else 0 end)+sum(case when a22='出勤' then 1 else 0 end)+sum(case when a23='出勤' then 1 else 0 end)+sum(case when a24='出勤' then 1 else 0 end)+sum(case when a25='出勤' then 1 else 0 end)+sum(case when a26='出勤' then 1 else 0 end)+sum(case when a27='出勤' then 1 else 0 end)+sum(case when a28='出勤' then 1 else 0 end)+sum(case when a29='出勤' then 1 else 0 end)+sum(case when a30='出勤' then 1 else 0 end)+sum(case when a31='出勤' then 1 else 0 end) as chuqin,"
				+"sum(case when a1='迟到' then 1 else 0 end)+sum(case when a2='迟到' then 1 else 0 end)+sum(case when a3='迟到' then 1 else 0 end)+sum(case when a4='迟到' then 1 else 0 end)+sum(case when a5='迟到' then 1 else 0 end)+sum(case when a6='迟到' then 1 else 0 end)+sum(case when a7='迟到' then 1 else 0 end)+sum(case when a8='迟到' then 1 else 0 end)+sum(case when a9='迟到' then 1 else 0 end)+sum(case when a10='迟到' then 1 else 0 end)+sum(case when a11='迟到' then 1 else 0 end)+sum(case when a12='迟到' then 1 else 0 end)+sum(case when a13='迟到' then 1 else 0 end)+sum(case when a14='迟到' then 1 else 0 end)+sum(case when a15='迟到' then 1 else 0 end)+sum(case when a16='迟到' then 1 else 0 end)+sum(case when a17='迟到' then 1 else 0 end)+sum(case when a18='迟到' then 1 else 0 end)+sum(case when a19='迟到' then 1 else 0 end)+sum(case when a20='迟到' then 1 else 0 end)+sum(case when a21='迟到' then 1 else 0 end)+sum(case when a22='迟到' then 1 else 0 end)+sum(case when a23='迟到' then 1 else 0 end)+sum(case when a24='迟到' then 1 else 0 end)+sum(case when a25='迟到' then 1 else 0 end)+sum(case when a26='迟到' then 1 else 0 end)+sum(case when a27='迟到' then 1 else 0 end)+sum(case when a28='迟到' then 1 else 0 end)+sum(case when a29='迟到' then 1 else 0 end)+sum(case when a30='迟到' then 1 else 0 end)+sum(case when a31='迟到' then 1 else 0 end)"
				+"+sum(case when a1='早退' then 1 else 0 end)+sum(case when a2='早退' then 1 else 0 end)+sum(case when a3='早退' then 1 else 0 end)+sum(case when a4='早退' then 1 else 0 end)+sum(case when a5='早退' then 1 else 0 end)+sum(case when a6='早退' then 1 else 0 end)+sum(case when a7='早退' then 1 else 0 end)+sum(case when a8='早退' then 1 else 0 end)+sum(case when a9='早退' then 1 else 0 end)+sum(case when a10='早退' then 1 else 0 end)+sum(case when a11='早退' then 1 else 0 end)+sum(case when a12='早退' then 1 else 0 end)+sum(case when a13='早退' then 1 else 0 end)+sum(case when a14='早退' then 1 else 0 end)+sum(case when a15='早退' then 1 else 0 end)+sum(case when a16='早退' then 1 else 0 end)+sum(case when a17='早退' then 1 else 0 end)+sum(case when a18='早退' then 1 else 0 end)+sum(case when a19='早退' then 1 else 0 end)+sum(case when a20='早退' then 1 else 0 end)+sum(case when a21='早退' then 1 else 0 end)+sum(case when a22='早退' then 1 else 0 end)+sum(case when a23='早退' then 1 else 0 end)+sum(case when a24='早退' then 1 else 0 end)+sum(case when a25='早退' then 1 else 0 end)+sum(case when a26='早退' then 1 else 0 end)+sum(case when a27='早退' then 1 else 0 end)+sum(case when a28='早退' then 1 else 0 end)+sum(case when a29='早退' then 1 else 0 end)+sum(case when a30='早退' then 1 else 0 end)+sum(case when a31='早退' then 1 else 0 end)"
				+"+sum(case when a1='中途离岗' then 1 else 0 end)+sum(case when a2='中途离岗' then 1 else 0 end)+sum(case when a3='中途离岗' then 1 else 0 end)+sum(case when a4='中途离岗' then 1 else 0 end)+sum(case when a5='中途离岗' then 1 else 0 end)+sum(case when a6='中途离岗' then 1 else 0 end)+sum(case when a7='中途离岗' then 1 else 0 end)+sum(case when a8='中途离岗' then 1 else 0 end)+sum(case when a9='中途离岗' then 1 else 0 end)+sum(case when a10='中途离岗' then 1 else 0 end)+sum(case when a11='中途离岗' then 1 else 0 end)+sum(case when a12='中途离岗' then 1 else 0 end)+sum(case when a13='中途离岗' then 1 else 0 end)+sum(case when a14='中途离岗' then 1 else 0 end)+sum(case when a15='中途离岗' then 1 else 0 end)+sum(case when a16='中途离岗' then 1 else 0 end)+sum(case when a17='中途离岗' then 1 else 0 end)+sum(case when a18='中途离岗' then 1 else 0 end)+sum(case when a19='中途离岗' then 1 else 0 end)+sum(case when a20='中途离岗' then 1 else 0 end)+sum(case when a21='中途离岗' then 1 else 0 end)+sum(case when a22='中途离岗' then 1 else 0 end)+sum(case when a23='中途离岗' then 1 else 0 end)+sum(case when a24='中途离岗' then 1 else 0 end)+sum(case when a25='中途离岗' then 1 else 0 end)+sum(case when a26='中途离岗' then 1 else 0 end)+sum(case when a27='中途离岗' then 1 else 0 end)+sum(case when a28='中途离岗' then 1 else 0 end)+sum(case when a29='中途离岗' then 1 else 0 end)+sum(case when a30='中途离岗' then 1 else 0 end)+sum(case when a31='中途离岗' then 1 else 0 end)"
				+"+sum(case when a1='上井' then 1 else 0 end)+sum(case when a2='上井' then 1 else 0 end)+sum(case when a3='上井' then 1 else 0 end)+sum(case when a4='上井' then 1 else 0 end)+sum(case when a5='上井' then 1 else 0 end)+sum(case when a6='上井' then 1 else 0 end)+sum(case when a7='上井' then 1 else 0 end)+sum(case when a8='上井' then 1 else 0 end)+sum(case when a9='上井' then 1 else 0 end)+sum(case when a10='上井' then 1 else 0 end)+sum(case when a11='上井' then 1 else 0 end)+sum(case when a12='上井' then 1 else 0 end)+sum(case when a13='上井' then 1 else 0 end)+sum(case when a14='上井' then 1 else 0 end)+sum(case when a15='上井' then 1 else 0 end)+sum(case when a16='上井' then 1 else 0 end)+sum(case when a17='上井' then 1 else 0 end)+sum(case when a18='上井' then 1 else 0 end)+sum(case when a19='上井' then 1 else 0 end)+sum(case when a20='上井' then 1 else 0 end)+sum(case when a21='上井' then 1 else 0 end)+sum(case when a22='上井' then 1 else 0 end)+sum(case when a23='上井' then 1 else 0 end)+sum(case when a24='上井' then 1 else 0 end)+sum(case when a25='上井' then 1 else 0 end)+sum(case when a26='上井' then 1 else 0 end)+sum(case when a27='上井' then 1 else 0 end)+sum(case when a28='上井' then 1 else 0 end)+sum(case when a29='上井' then 1 else 0 end)+sum(case when a30='上井' then 1 else 0 end)+sum(case when a31='上井' then 1 else 0 end)"
				+"+sum(case when a1='待岗' then 1 else 0 end)+sum(case when a2='待岗' then 1 else 0 end)+sum(case when a3='待岗' then 1 else 0 end)+sum(case when a4='待岗' then 1 else 0 end)+sum(case when a5='待岗' then 1 else 0 end)+sum(case when a6='待岗' then 1 else 0 end)+sum(case when a7='待岗' then 1 else 0 end)+sum(case when a8='待岗' then 1 else 0 end)+sum(case when a9='待岗' then 1 else 0 end)+sum(case when a10='待岗' then 1 else 0 end)+sum(case when a11='待岗' then 1 else 0 end)+sum(case when a12='待岗' then 1 else 0 end)+sum(case when a13='待岗' then 1 else 0 end)+sum(case when a14='待岗' then 1 else 0 end)+sum(case when a15='待岗' then 1 else 0 end)+sum(case when a16='待岗' then 1 else 0 end)+sum(case when a17='待岗' then 1 else 0 end)+sum(case when a18='待岗' then 1 else 0 end)+sum(case when a19='待岗' then 1 else 0 end)+sum(case when a20='待岗' then 1 else 0 end)+sum(case when a21='待岗' then 1 else 0 end)+sum(case when a22='待岗' then 1 else 0 end)+sum(case when a23='待岗' then 1 else 0 end)+sum(case when a24='待岗' then 1 else 0 end)+sum(case when a25='待岗' then 1 else 0 end)+sum(case when a26='待岗' then 1 else 0 end)+sum(case when a27='待岗' then 1 else 0 end)+sum(case when a28='待岗' then 1 else 0 end)+sum(case when a29='待岗' then 1 else 0 end)+sum(case when a30='待岗' then 1 else 0 end)+sum(case when a31='待岗' then 1 else 0 end)"
				+"+sum(case when a1='出勤' then 1 else 0 end)+sum(case when a2='出勤' then 1 else 0 end)+sum(case when a3='出勤' then 1 else 0 end)+sum(case when a4='出勤' then 1 else 0 end)+sum(case when a5='出勤' then 1 else 0 end)+sum(case when a6='出勤' then 1 else 0 end)+sum(case when a7='出勤' then 1 else 0 end)+sum(case when a8='出勤' then 1 else 0 end)+sum(case when a9='出勤' then 1 else 0 end)+sum(case when a10='出勤' then 1 else 0 end)+sum(case when a11='出勤' then 1 else 0 end)+sum(case when a12='出勤' then 1 else 0 end)+sum(case when a13='出勤' then 1 else 0 end)+sum(case when a14='出勤' then 1 else 0 end)+sum(case when a15='出勤' then 1 else 0 end)+sum(case when a16='出勤' then 1 else 0 end)+sum(case when a17='出勤' then 1 else 0 end)+sum(case when a18='出勤' then 1 else 0 end)+sum(case when a19='出勤' then 1 else 0 end)+sum(case when a20='出勤' then 1 else 0 end)+sum(case when a21='出勤' then 1 else 0 end)+sum(case when a22='出勤' then 1 else 0 end)+sum(case when a23='出勤' then 1 else 0 end)+sum(case when a24='出勤' then 1 else 0 end)+sum(case when a25='出勤' then 1 else 0 end)+sum(case when a26='出勤' then 1 else 0 end)+sum(case when a27='出勤' then 1 else 0 end)+sum(case when a28='出勤' then 1 else 0 end)+sum(case when a29='出勤' then 1 else 0 end)+sum(case when a30='出勤' then 1 else 0 end)+sum(case when a31='出勤' then 1 else 0 end) as shanggangtianshu,"
				+"sum(case when a1='上井' then 1 else 0 end)+sum(case when a2='上井' then 1 else 0 end)+sum(case when a3='上井' then 1 else 0 end)+sum(case when a4='上井' then 1 else 0 end)+sum(case when a5='上井' then 1 else 0 end)+sum(case when a6='上井' then 1 else 0 end)+sum(case when a7='上井' then 1 else 0 end)+sum(case when a8='上井' then 1 else 0 end)+sum(case when a9='上井' then 1 else 0 end)+sum(case when a10='上井' then 1 else 0 end)+sum(case when a11='上井' then 1 else 0 end)+sum(case when a12='上井' then 1 else 0 end)+sum(case when a13='上井' then 1 else 0 end)+sum(case when a14='上井' then 1 else 0 end)+sum(case when a15='上井' then 1 else 0 end)+sum(case when a16='上井' then 1 else 0 end)+sum(case when a17='上井' then 1 else 0 end)+sum(case when a18='上井' then 1 else 0 end)+sum(case when a19='上井' then 1 else 0 end)+sum(case when a20='上井' then 1 else 0 end)+sum(case when a21='上井' then 1 else 0 end)+sum(case when a22='上井' then 1 else 0 end)+sum(case when a23='上井' then 1 else 0 end)+sum(case when a24='上井' then 1 else 0 end)+sum(case when a25='上井' then 1 else 0 end)+sum(case when a26='上井' then 1 else 0 end)+sum(case when a27='上井' then 1 else 0 end)+sum(case when a28='上井' then 1 else 0 end)+sum(case when a29='上井' then 1 else 0 end)+sum(case when a30='上井' then 1 else 0 end)+sum(case when a31='上井' then 1 else 0 end) as shangjing,"
				+"sum(case when a1='丧假' then 1 else 0 end)+sum(case when a2='丧假' then 1 else 0 end)+sum(case when a3='丧假' then 1 else 0 end)+sum(case when a4='丧假' then 1 else 0 end)+sum(case when a5='丧假' then 1 else 0 end)+sum(case when a6='丧假' then 1 else 0 end)+sum(case when a7='丧假' then 1 else 0 end)+sum(case when a8='丧假' then 1 else 0 end)+sum(case when a9='丧假' then 1 else 0 end)+sum(case when a10='丧假' then 1 else 0 end)+sum(case when a11='丧假' then 1 else 0 end)+sum(case when a12='丧假' then 1 else 0 end)+sum(case when a13='丧假' then 1 else 0 end)+sum(case when a14='丧假' then 1 else 0 end)+sum(case when a15='丧假' then 1 else 0 end)+sum(case when a16='丧假' then 1 else 0 end)+sum(case when a17='丧假' then 1 else 0 end)+sum(case when a18='丧假' then 1 else 0 end)+sum(case when a19='丧假' then 1 else 0 end)+sum(case when a20='丧假' then 1 else 0 end)+sum(case when a21='丧假' then 1 else 0 end)+sum(case when a22='丧假' then 1 else 0 end)+sum(case when a23='丧假' then 1 else 0 end)+sum(case when a24='丧假' then 1 else 0 end)+sum(case when a25='丧假' then 1 else 0 end)+sum(case when a26='丧假' then 1 else 0 end)+sum(case when a27='丧假' then 1 else 0 end)+sum(case when a28='丧假' then 1 else 0 end)+sum(case when a29='丧假' then 1 else 0 end)+sum(case when a30='丧假' then 1 else 0 end)+sum(case when a31='丧假' then 1 else 0 end) as sangjia,"
				+"sum(case when a1='产假' then 1 else 0 end)+sum(case when a2='产假' then 1 else 0 end)+sum(case when a3='产假' then 1 else 0 end)+sum(case when a4='产假' then 1 else 0 end)+sum(case when a5='产假' then 1 else 0 end)+sum(case when a6='产假' then 1 else 0 end)+sum(case when a7='产假' then 1 else 0 end)+sum(case when a8='产假' then 1 else 0 end)+sum(case when a9='产假' then 1 else 0 end)+sum(case when a10='产假' then 1 else 0 end)+sum(case when a11='产假' then 1 else 0 end)+sum(case when a12='产假' then 1 else 0 end)+sum(case when a13='产假' then 1 else 0 end)+sum(case when a14='产假' then 1 else 0 end)+sum(case when a15='产假' then 1 else 0 end)+sum(case when a16='产假' then 1 else 0 end)+sum(case when a17='产假' then 1 else 0 end)+sum(case when a18='产假' then 1 else 0 end)+sum(case when a19='产假' then 1 else 0 end)+sum(case when a20='产假' then 1 else 0 end)+sum(case when a21='产假' then 1 else 0 end)+sum(case when a22='产假' then 1 else 0 end)+sum(case when a23='产假' then 1 else 0 end)+sum(case when a24='产假' then 1 else 0 end)+sum(case when a25='产假' then 1 else 0 end)+sum(case when a26='产假' then 1 else 0 end)+sum(case when a27='产假' then 1 else 0 end)+sum(case when a28='产假' then 1 else 0 end)+sum(case when a29='产假' then 1 else 0 end)+sum(case when a30='产假' then 1 else 0 end)+sum(case when a31='产假' then 1 else 0 end) as chanjia,"
				+"sum(case when a1='待岗' then 1 else 0 end)+sum(case when a2='待岗' then 1 else 0 end)+sum(case when a3='待岗' then 1 else 0 end)+sum(case when a4='待岗' then 1 else 0 end)+sum(case when a5='待岗' then 1 else 0 end)+sum(case when a6='待岗' then 1 else 0 end)+sum(case when a7='待岗' then 1 else 0 end)+sum(case when a8='待岗' then 1 else 0 end)+sum(case when a9='待岗' then 1 else 0 end)+sum(case when a10='待岗' then 1 else 0 end)+sum(case when a11='待岗' then 1 else 0 end)+sum(case when a12='待岗' then 1 else 0 end)+sum(case when a13='待岗' then 1 else 0 end)+sum(case when a14='待岗' then 1 else 0 end)+sum(case when a15='待岗' then 1 else 0 end)+sum(case when a16='待岗' then 1 else 0 end)+sum(case when a17='待岗' then 1 else 0 end)+sum(case when a18='待岗' then 1 else 0 end)+sum(case when a19='待岗' then 1 else 0 end)+sum(case when a20='待岗' then 1 else 0 end)+sum(case when a21='待岗' then 1 else 0 end)+sum(case when a22='待岗' then 1 else 0 end)+sum(case when a23='待岗' then 1 else 0 end)+sum(case when a24='待岗' then 1 else 0 end)+sum(case when a25='待岗' then 1 else 0 end)+sum(case when a26='待岗' then 1 else 0 end)+sum(case when a27='待岗' then 1 else 0 end)+sum(case when a28='待岗' then 1 else 0 end)+sum(case when a29='待岗' then 1 else 0 end)+sum(case when a30='待岗' then 1 else 0 end)+sum(case when a31='待岗' then 1 else 0 end) as daigang "
				+"  from vw_work where (year(attendance_date) = ? and month(attendance_date)=? and FIND_IN_SET(dept_id, getChildLst(?))) and status='2' group by name";
		if(flag){
			list=getListBySql(sql, new String[]{String.valueOf(ye),String.valueOf(mon),deptid});
		}else{
			list=getListBySql(sql1, new String[]{String.valueOf(ye),String.valueOf(mon),deptid});
		}
		return list;
	}
}
